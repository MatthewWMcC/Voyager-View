/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={4444:(e,t,n)=>{"use strict";n.d(t,{BH:()=>d,LL:()=>y,ZR:()=>g,gQ:()=>R,hu:()=>r,g5:()=>i,US:()=>s,h$:()=>a,r3:()=>E,Sg:()=>p,p$:()=>u,vZ:()=>P,gK:()=>A,m9:()=>L,GJ:()=>x,xb:()=>I,uI:()=>f,Yr:()=>m,b$:()=>_,w9:()=>k,cI:()=>w,UI:()=>S,xO:()=>D,DV:()=>T,ug:()=>M,dS:()=>O,Pz:()=>b});const r=function(e,t){if(!e)throw i(t)},i=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},o=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],o=t+1<e.length,s=o?e[t+1]:0,a=t+2<e.length,l=a?e[t+2]:0,c=i>>2,u=(3&i)<<4|s>>4;let h=(15&s)<<2|l>>6,d=63&l;a||(d=64,o||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(o(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const s=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==o||null==s||null==a)throw Error();const l=i<<2|o>>4;if(r.push(l),64!==s){const e=o<<4&240|s>>2;if(r.push(e),64!==a){const e=s<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},a=function(e){const t=o(e);return s.encodeByteArray(t,!0)},l=function(e){return a(e).replace(/\./g,"")},c=function(e){try{return s.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function u(e){return h(void 0,e)}function h(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=h(e[n],t[n]));return e}class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function p(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(o)),""].join(".")}function f(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}function _(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function m(){return!1}class g extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,y.prototype.create)}}class y{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?function(e,t){return e.replace(v,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",s=`${this.serviceName}: ${o} (${r}).`;return new g(r,s,n)}}const v=/\{\$([^}]+)}/g;function w(e){return JSON.parse(e)}function b(e){return JSON.stringify(e)}const C=function(e){let t={},n={},r={},i="";try{const o=e.split(".");t=w(c(o[0])||""),n=w(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},k=function(e){const t=C(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},x=function(e){const t=C(e).claims;return"object"==typeof t&&!0===t.admin};function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function I(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function S(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function P(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(N(n)&&N(o)){if(!P(n,o))return!1}else if(n!==o)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function N(e){return null!==e&&"object"==typeof e}function D(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}class R{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,o=this.chain_[0],s=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=l^s&(a^l),i=1518500249):(r=s^a^l,i=1859775393):e<60?(r=s&a|l&(s|a),i=2400959708):(r=s^a^l,i=3395469782);const t=(o<<5|o>>>27)+r+c+i+n[e]&4294967295;c=l,l=a,a=4294967295&(s<<30|s>>>2),s=o,o=t}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}function A(e,t){return`${e} failed: ${t} argument `}const O=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let o=e.charCodeAt(i);if(o>=55296&&o<=56319){const t=o-55296;i++,r(i<e.length,"Surrogate pair missing trail surrogate."),o=65536+(t<<10)+(e.charCodeAt(i)-56320)}o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):o<65536?(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},M=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function L(e){return e&&e._delegate?e._delegate:e}},1315:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(8081),i=n.n(r),o=n(3645),s=n.n(o)()(i());s.push([e.id,'h1,h2,h3,h4,h5,h6,p{margin:0}body{background-color:#e9ebee;font-family:"Roboto",sans-serif;font-style:normal;font-weight:normal;font-size:14px;color:#36454f;height:100vh;margin:0px}#app-container{padding:10px 20px;display:flex;justify-content:center;box-sizing:border-box}@media only screen and (min-width: 1px)and (max-width: 599px){#app-container{padding:2px}}#app-container .main-container{display:flex;width:750px;align-items:center;flex-direction:column}@media only screen and (min-width: 600px)and (max-width: 750px){#app-container .main-container{width:100%}}#app-container .main-container .top-row{width:100%;display:flex;flex-direction:row;justify-content:space-between}#app-container .main-container .top-row .logo{height:fit-content;width:50%}#app-container .main-container .top-row .logo img{height:30px}#app-container .main-container .top-row .date-picker-outer{width:50%;display:flex;justify-content:end;align-items:center}#app-container .main-container .subtitle{width:100%;padding-left:25px;box-sizing:border-box;font-size:12px}#app-container .main-container .middle-row{padding-top:10px;width:100%}#app-container .main-container .middle-row .error-display{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}#app-container .main-container .middle-row .error-display h3{font-size:20px;text-align:center}#app-container .main-container .button-row{display:flex;justify-content:center;align-items:center}@media only screen and (min-width: 1px)and (max-width: 599px){#app-container .main-container .button-row{margin-top:5px}}#app-container .main-container .button-row .space{width:10px}#app-container .main-container .button-row .arrow-button{width:100px;display:flex;padding:5px;align-items:center;justify-content:center}#app-container .image-display{display:flex;flex-direction:column;padding:20px;border:#36454f 2px solid;border-radius:8px;align-items:center}@media only screen and (min-width: 1px)and (max-width: 599px){#app-container .image-display{padding:10px;border:none;border-top:#36454f 2px solid;border-bottom:#36454f 2px solid}}#app-container .image-display .title-elements{display:flex;flex-direction:row;width:100%;justify-content:space-around}@media only screen and (min-width: 1px)and (max-width: 599px){#app-container .image-display .title-elements{flex-direction:column}#app-container .image-display .title-elements .title{font-size:14px}#app-container .image-display .title-elements .date{font-size:12px;font-weight:normal}}#app-container .image-display .title-elements h2{font-size:16px}#app-container .image-display img{margin:10px 0;max-width:100%;max-height:50vh}#app-container .image-display .bottom-row{display:flex;align-items:center}@media only screen and (min-width: 1px)and (max-width: 599px){#app-container .image-display .bottom-row{flex-direction:column}}#app-container .image-display .bottom-row .like-section{width:100px;height:100px;display:flex;justify-content:space-between;flex-direction:column;align-items:center}@media only screen and (min-width: 1px)and (max-width: 599px){#app-container .image-display .bottom-row .like-section{flex-direction:row;height:fit-content;justify-content:space-around;width:100%}#app-container .image-display .bottom-row .like-section button{margin-left:10px}}#app-container .image-display .bottom-row .like-section button{width:65px}#app-container .image-display .bottom-row .like-section .like-display{font-size:40px;font-weight:lighter}#app-container .image-display .bottom-row .like-section .like-display.liked{color:#ee4b2b}#app-container .image-display .bottom-row .description{width:100%;max-height:20vh;font-size:14px;font-weight:normal;overflow:auto;padding-right:5px}@media only screen and (min-width: 1px)and (max-width: 599px){#app-container .image-display .bottom-row .description{max-height:100vh}}.dropdown-container{height:150px;width:100%;height:fit-content;position:relative}.dropdown-container .dropdown-options{background-color:#fff;border-radius:0 0 10px 10px;width:100%;overflow:hidden;position:absolute;box-shadow:rgba(100,100,111,.2) 0px 7px 29px 0px}.dropdown-container .dropdown-options .dropdown-option{height:24px;display:flex;align-items:center;padding-left:5px;cursor:pointer}.dropdown-container .dropdown-options .dropdown-option:hover,.dropdown-container .dropdown-options .dropdown-option.focused{background-color:#c5cdd8}.dropdown-container .dropdown-options .dropdown-option.selected{background-color:#0450e7;color:#fff}.dropdown-container .dropdown-icon{position:absolute;top:5px;right:10px;height:10px;color:#7c817c;pointer-events:none}input.select-options{display:flex;flex-direction:row;width:100%;height:24px;background:#fff;border:1px solid #7c817c;border-radius:4px;color:#36454f;cursor:pointer;padding:0;padding-left:10px;box-sizing:border-box}input.select-options::selection{color:none;background:none}input.select-options.open{border-radius:4px 4px 0 0}.btn-styled{background-color:#0450e7;color:#fff;border-style:none;padding:5px 10px;border-radius:4px;font-size:16px;cursor:pointer}.btn-styled.secondary{background-color:#fff;color:#36454f}.btn-styled.small{background-color:#fff;border:#36454f 1px solid;font-size:14px;color:#000}.btn-styled:hover{background-color:#7c817c}.btn-styled:focus-visible{border:#000 2px solid}.btn-styled.disabled{cursor:not-allowed;background:#c5cdd8}.date-picker-container{width:200px;height:32px;position:relative}.date-picker-container input.date-display{display:flex;flex-direction:row;width:100%;height:100%;background:#fff;border:1px solid #7c817c;border-radius:4px;color:#36454f;text-align:center;cursor:pointer;padding:0;font-size:16px;padding-left:10px;box-sizing:border-box}.date-picker-container input.date-display::selection{color:none;background:none}.date-picker-container input.date-display:focus{border:none;outline:0;border-bottom:#0082ba 2px solid}.date-picker-container input.date-display.focused{border-bottom:#0082ba 2px solid}.date-picker-container .icon{position:absolute;right:5px;top:50%;transform:translate(0, -40%);color:#36454f;background-color:#fff;background:transparent;z-index:1;height:60%;pointer-events:none}.date-picker-container .icon img{height:100%}.date-picker-container .date-calendar-container{position:absolute;height:fit-content;width:250px;right:0;background-color:#fff;border:#7c817c solid 1px;box-shadow:rgba(100,100,111,.2) 0px 7px 29px 0px;border-radius:5px;padding:10px;z-index:2}.date-picker-container .date-calendar-container .top-calendar-row{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.date-picker-container .date-calendar-container .top-calendar-row .month-dropdown{width:125px}.date-picker-container .date-calendar-container .top-calendar-row .year-dropdown{width:75px}.date-picker-container .date-calendar-container .middle-calendar-row{margin-top:10px}.date-picker-container .date-calendar-container .middle-calendar-row table{display:table;width:100%}.date-picker-container .date-calendar-container .middle-calendar-row table tr{display:flex;justify-content:space-around;padding-bottom:2px}.date-picker-container .date-calendar-container .middle-calendar-row table tr td{display:flex;width:100%;justify-content:center;align-items:center;margin:0 2px}.date-picker-container .date-calendar-container .middle-calendar-row table tr td button.td-button{width:100%;border-style:none;border-radius:4px;padding:4px;cursor:pointer}.date-picker-container .date-calendar-container .middle-calendar-row table tr td button.td-button:hover{background-color:#7c817c}.date-picker-container .date-calendar-container .middle-calendar-row table tr td button.td-button:focus-visible{border:#000 2px solid}.date-picker-container .date-calendar-container .middle-calendar-row table tr td button.td-button.disabled{pointer-events:none}.date-picker-container .date-calendar-container .middle-calendar-row table tr td button.td-button.selected{background-color:#0450e7;color:#fff}.date-picker-container .date-calendar-container .bottom-calendar-row{display:flex;align-items:center;justify-content:space-between;margin-top:10px}::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{border-radius:3px;background-color:transparent}::-webkit-scrollbar-thumb{background:#c5cdd8;border-radius:3px}',""]);const a=s},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&s[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),t.push(u))}},t}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},5503:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FirebaseError:()=>r.ZR,SDK_VERSION:()=>r.Jn,_DEFAULT_ENTRY_NAME:()=>r.l4,_addComponent:()=>r.H9,_addOrOverwriteComponent:()=>r.Vr,_apps:()=>r.Af,_clearComponents:()=>r.Z8,_components:()=>r.lz,_getProvider:()=>r.qX,_registerComponent:()=>r.Xd,_removeServiceInstance:()=>r.wN,deleteApp:()=>r.P2,getApp:()=>r.Mq,getApps:()=>r.C6,initializeApp:()=>r.ZF,onLog:()=>r.TP,registerVersion:()=>r.KN,setLogLevel:()=>r.Ub});var r=n(2238);(0,r.KN)("firebase","9.6.3","app")},2956:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DataSnapshot:()=>Ti,Database:()=>bo,OnDisconnect:()=>wi,QueryConstraint:()=>$i,TransactionResult:()=>No,_QueryImpl:()=>bi,_QueryParams:()=>gt,_ReferenceImpl:()=>Ei,_TEST_ACCESS_forceRestClient:()=>Ao,_TEST_ACCESS_hijackHash:()=>Ro,_repoManagerDatabaseFromApp:()=>wo,_setSDKVersion:()=>u,_validatePathString:()=>Mr,_validateWritablePath:()=>Lr,child:()=>Pi,connectDatabaseEmulator:()=>ko,enableLogging:()=>To,endAt:()=>Gi,endBefore:()=>Ji,equalTo:()=>mo,get:()=>Fi,getDatabase:()=>Co,goOffline:()=>xo,goOnline:()=>Eo,increment:()=>Po,limitToFirst:()=>ro,limitToLast:()=>oo,off:()=>Yi,onChildAdded:()=>Wi,onChildChanged:()=>Bi,onChildMoved:()=>Hi,onChildRemoved:()=>Vi,onDisconnect:()=>Ni,onValue:()=>Ui,orderByChild:()=>ao,orderByKey:()=>co,orderByPriority:()=>ho,orderByValue:()=>fo,push:()=>Di,query:()=>go,ref:()=>Ii,refFromURL:()=>Si,remove:()=>Ri,runTransaction:()=>Do,serverTimestamp:()=>So,set:()=>Ai,setPriority:()=>Oi,setWithPriority:()=>Mi,startAfter:()=>to,startAt:()=>Zi,update:()=>Li});var r=n(2238),i=n(8463),o=n(4444),s=n(3333);const a="@firebase/database",l="0.12.5";let c="";function u(e){c=e}class h{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,o.Pz)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,o.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class d{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,o.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const p=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new h(t)}}catch(e){}return new d},f=p("localStorage"),_=p("sessionStorage"),m=new s.Yd("@firebase/database"),g=function(){let e=1;return function(){return e++}}(),y=function(e){const t=(0,o.dS)(e),n=new o.gQ;n.update(t);const r=n.digest();return o.US.encodeByteArray(r)},v=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=v.apply(null,r):t+="object"==typeof r?(0,o.Pz)(r):r,t+=" "}return t};let w=null,b=!0;const C=function(e,t){(0,o.hu)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(m.logLevel=s.in.VERBOSE,w=m.log.bind(m),t&&_.set("logging_enabled",!0)):"function"==typeof e?w=e:(w=null,_.remove("logging_enabled"))},k=function(...e){if(!0===b&&(b=!1,null===w&&!0===_.get("logging_enabled")&&C(!0)),w){const t=v.apply(null,e);w(t)}},x=function(e){return function(...t){k(e,...t)}},E=function(...e){const t="FIREBASE INTERNAL ERROR: "+v(...e);m.error(t)},T=function(...e){const t=`FIREBASE FATAL ERROR: ${v(...e)}`;throw m.error(t),new Error(t)},I=function(...e){const t="FIREBASE WARNING: "+v(...e);m.warn(t)},S=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},P="[MIN_NAME]",N="[MAX_NAME]",D=function(e,t){if(e===t)return 0;if(e===P||t===N)return-1;if(t===P||e===N)return 1;{const n=j(e),r=j(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},R=function(e,t){return e===t?0:e<t?-1:1},A=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+(0,o.Pz)(t))},O=function(e){if("object"!=typeof e||null===e)return(0,o.Pz)(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=(0,o.Pz)(t[r]),n+=":",n+=O(e[t[r]]);return n+="}",n},M=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function L(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const F=function(e){(0,o.hu)(!S(e),"Invalid JSON number");let t,n,r,i,s;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=i+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));const a=[];for(s=52;s;s-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;s-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse();const l=a.join("");let c="";for(s=0;s<64;s+=8){let e=parseInt(l.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()},q=new RegExp("^-?(0*)\\d{1,10}$"),j=function(e){if(q.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},z=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw I("Exception was thrown by user callback.",t),e}),Math.floor(0))}},U=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};class W{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){I(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class B{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(k("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',I(e)}}class H{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}H.OWNER="owner";const V=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Y="websocket",$="long_polling";class K{constructor(e,t,n,r,i=!1,o="",s=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=f.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&f.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function G(e,t,n){let r;if((0,o.hu)("string"==typeof t,"typeof type must == string"),(0,o.hu)("object"==typeof n,"typeof params must == object"),t===Y)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==$)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return L(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}class Q{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,o.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,o.p$)(this.counters_)}}const J={},X={};function Z(e){const t=e.toString();return J[t]||(J[t]=new Q),J[t]}class ee{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&z((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class te{constructor(e,t,n,r,i,o,s){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=x(e),this.stats_=Z(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),G(t,$,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ee(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if((0,o.Yr)()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new ne(((...e)=>{const[t,n,r,i,o]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===t)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&V.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){te.forceAllow_=!0}static forceDisallow(){te.forceDisallow_=!0}static isAvailable(){return!((0,o.Yr)()||!te.forceAllow_&&(te.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,o.Pz)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=(0,o.h$)(t),r=M(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,o.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,o.Pz)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class ne{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,o.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=g(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=ne.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){k("frame writing exception"),e.stack&&k(e.stack),k(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||k("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){(0,o.Yr)()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{k("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let re=null;"undefined"!=typeof MozWebSocket?re=MozWebSocket:"undefined"!=typeof WebSocket&&(re=WebSocket);class ie{constructor(e,t,n,r,i,o,s){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=x(this.connId),this.stats_=Z(t),this.connURL=ie.connectionURL_(t,o,s,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r){const i={v:"5"};return!(0,o.Yr)()&&"undefined"!=typeof location&&location.hostname&&V.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),G(e,Y,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f.set("previous_websocket_failure",!0);try{if((0,o.Yr)()){const e=this.nodeAdmin?"AdminNode":"Node",t={headers:{"User-Agent":`Firebase/5/${c}/${process.platform}/${e}`,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(t.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(t.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n=process.env,r=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;r&&(t.proxy={origin:r}),this.mySock=new re(this.connURL,[],t)}else{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new re(this.connURL,[],e)}}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){ie.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==re&&!ie.forceDisallow_}static previouslyFailed(){return f.isInMemoryStorage||!0===f.get("previous_websocket_failure")}markConnectionHealthy(){f.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=(0,o.cI)(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if((0,o.hu)(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=(0,o.Pz)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=M(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ie.responsesRequiredToBeHealthy=2,ie.healthyTimeout=3e4;class oe{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[te,ie]}initTransports_(e){const t=ie&&ie.isAvailable();let n=t&&!ie.previouslyFailed();if(e.webSocketOnly&&(t||I("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[ie];else{const e=this.transports_=[];for(const t of oe.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}class se{constructor(e,t,n,r,i,o,s,a,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=x("c:"+this.id+":"),this.transportManager_=new oe(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=U((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=A("t",e),n=A("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=A("t",e),n=A("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=A("t",e);if("d"in e){const n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?E("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&I("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),U((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):U((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class ae{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class le{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,o.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){(0,o.hu)(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class ce extends le{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,o.uI)()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new ce}getInitialEvent(e){return(0,o.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class ue{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function he(){return new ue("")}function de(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function pe(e){return e.pieces_.length-e.pieceNum_}function fe(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new ue(e.pieces_,t)}function _e(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function me(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function ge(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new ue(t,0)}function ye(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof ue)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new ue(n,0)}function ve(e){return e.pieceNum_>=e.pieces_.length}function we(e,t){const n=de(e),r=de(t);if(null===n)return t;if(n===r)return we(fe(e),fe(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function be(e,t){const n=me(e,0),r=me(t,0);for(let e=0;e<n.length&&e<r.length;e++){const t=D(n[e],r[e]);if(0!==t)return t}return n.length===r.length?0:n.length<r.length?-1:1}function Ce(e,t){if(pe(e)!==pe(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function ke(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(pe(e)>pe(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class xe{constructor(e,t){this.errorPrefix_=t,this.parts_=me(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=(0,o.ug)(this.parts_[e]);Ee(this)}}function Ee(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Te(e))}function Te(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Ie extends le{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Ie}getInitialEvent(e){return(0,o.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Se=1e3;class Pe extends ae{constructor(e,t,n,r,i,s,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Pe.nextPersistentConnectionId_++,this.log_=x("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Se,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!(0,o.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Ie.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&ce.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r,a:e,b:t};this.log_((0,o.Pz)(i)),(0,o.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new o.BH,n={p:e._path.toString(),q:e._queryObject},r={action:"g",request:n,onComplete:e=>{const r=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,r,!1,null),t.resolve(r)):t.reject(r)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const e=this.outstandingGets_[i];void 0!==e&&r===e&&(delete this.outstandingGets_[i],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+i+" timed out on connection"),t.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),(0,o.hu)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,o.hu)(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const o=i.d,s=i.s;Pe.warnOnListenWarnings_(o,t),(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==s&&this.removeListen_(n,r),e.onComplete&&e.onComplete(s,o))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&(0,o.r3)(e,"w")){const n=(0,o.DV)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();I(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||(0,o.GJ)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=(0,o.w9)(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,o.hu)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+(0,o.Pz)(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):E("Unrecognized action received from server: "+(0,o.Pz)(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){(0,o.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Se,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Se,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Se),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Pe.nextConnectionId_++,i=this.lastSessionId;let s=!1,a=null;const l=function(){a?a.close():(s=!0,n())},c=function(e){(0,o.hu)(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[o,l]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);s?k("getToken() completed but was canceled"):(k("getToken() completed. Creating connection."),this.authToken_=o&&o.accessToken,this.appCheckToken_=l&&l.token,a=new se(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{I(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&I(e),l())}}}interrupt(e){k("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){k("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,o.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Se,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>O(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new ue(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){k("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){k("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";(0,o.Yr)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+c.replace(/\./g,"-")]=1,(0,o.uI)()?e["framework.cordova"]=1:(0,o.b$)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ce.getInstance().currentlyOnline();return(0,o.xb)(this.interruptReasons_)&&e}}Pe.nextPersistentConnectionId_=0,Pe.nextConnectionId_=0;class Ne{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ne(e,t)}}class De{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Ne(P,e),r=new Ne(P,t);return 0!==this.compare(n,r)}minPost(){return Ne.MIN}}let Re;class Ae extends De{static get __EMPTY_NODE(){return Re}static set __EMPTY_NODE(e){Re=e}compare(e,t){return D(e.name,t.name)}isDefinedOn(e){throw(0,o.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ne.MIN}maxPost(){return new Ne(N,Re)}makePost(e,t){return(0,o.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new Ne(e,Re)}toString(){return".key"}}const Oe=new Ae;class Me{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Le{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Le.RED,this.left=null!=r?r:Fe.EMPTY_NODE,this.right=null!=i?i:Fe.EMPTY_NODE}copy(e,t,n,r,i){return new Le(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Fe.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Fe.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Le.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Le.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Le.RED=!0,Le.BLACK=!1;class Fe{constructor(e,t=Fe.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Fe(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Le.BLACK,null,null))}remove(e){return new Fe(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Le.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Me(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Me(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Me(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Me(this.root_,null,this.comparator_,!0,e)}}function qe(e,t){return D(e.name,t.name)}function je(e,t){return D(e,t)}let ze;Fe.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new Le(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Ue=function(e){return"number"==typeof e?"number:"+F(e):"string:"+e},We=function(e){if(e.isLeafNode()){const t=e.val();(0,o.hu)("string"==typeof t||"number"==typeof t||"object"==typeof t&&(0,o.r3)(t,".sv"),"Priority must be a string or number.")}else(0,o.hu)(e===ze||e.isEmpty(),"priority of unexpected type.");(0,o.hu)(e===ze||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Be,He,Ve;class Ye{constructor(e,t=Ye.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,(0,o.hu)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),We(this.priorityNode_)}static set __childrenNodeConstructor(e){Be=e}static get __childrenNodeConstructor(){return Be}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Ye(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Ye.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ve(e)?this:".priority"===de(e)?this.priorityNode_:Ye.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Ye.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=de(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:((0,o.hu)(".priority"!==n||1===pe(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Ye.__childrenNodeConstructor.EMPTY_NODE.updateChild(fe(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ue(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?F(this.value_):this.value_,this.lazyHash_=y(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Ye.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Ye.__childrenNodeConstructor?-1:((0,o.hu)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=Ye.VALUE_TYPE_ORDER.indexOf(t),i=Ye.VALUE_TYPE_ORDER.indexOf(n);return(0,o.hu)(r>=0,"Unknown leaf type: "+t),(0,o.hu)(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Ye.VALUE_TYPE_ORDER=["object","boolean","number","string"];const $e=new class extends De{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?D(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ne.MIN}maxPost(){return new Ne(N,new Ye("[PRIORITY-POST]",Ve))}makePost(e,t){const n=He(e);return new Ne(t,new Ye("[PRIORITY-POST]",n))}toString(){return".priority"}},Ke=Math.log(2);class Ge{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Ke,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Qe=function(e,t,n,r){e.sort(t);const i=function(t,r){const o=r-t;let s,a;if(0===o)return null;if(1===o)return s=e[t],a=n?n(s):s,new Le(a,s.node,Le.BLACK,null,null);{const l=parseInt(o/2,10)+t,c=i(t,l),u=i(l+1,r);return s=e[l],a=n?n(s):s,new Le(a,s.node,Le.BLACK,c,u)}},o=function(t){let r=null,o=null,s=e.length;const a=function(t,r){const o=s-t,a=s;s-=t;const c=i(o+1,a),u=e[o],h=n?n(u):u;l(new Le(h,u.node,r,null,c))},l=function(e){r?(r.left=e,r=e):(o=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,Le.BLACK):(a(r,Le.BLACK),a(r,Le.RED))}return o}(new Ge(e.length));return new Fe(r||t,o)};let Je;const Xe={};class Ze{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,o.hu)(Xe&&$e,"ChildrenNode.ts has not been loaded"),Je=Je||new Ze({".priority":Xe},{".priority":$e}),Je}get(e){const t=(0,o.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Fe?t:null}hasIndex(e){return(0,o.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,o.hu)(e!==Oe,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(Ne.Wrap);let s,a=i.getNext();for(;a;)r=r||e.isDefinedOn(a.node),n.push(a),a=i.getNext();s=r?Qe(n,e.getCompare()):Xe;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=s,new Ze(u,c)}addToIndexes(e,t){const n=(0,o.UI)(this.indexes_,((n,r)=>{const i=(0,o.DV)(this.indexSet_,r);if((0,o.hu)(i,"Missing index implementation for "+r),n===Xe){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(Ne.Wrap);let o=r.getNext();for(;o;)o.name!==e.name&&n.push(o),o=r.getNext();return n.push(e),Qe(n,i.getCompare())}return Xe}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new Ne(e.name,r))),i.insert(e,e.node)}}));return new Ze(n,this.indexSet_)}removeFromIndexes(e,t){const n=(0,o.UI)(this.indexes_,(n=>{if(n===Xe)return n;{const r=t.get(e.name);return r?n.remove(new Ne(e.name,r)):n}}));return new Ze(n,this.indexSet_)}}let et;class tt{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&We(this.priorityNode_),this.children_.isEmpty()&&(0,o.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return et||(et=new tt(new Fe(je),null,Ze.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||et}updatePriority(e){return this.children_.isEmpty()?this:new tt(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?et:t}}getChild(e){const t=de(e);return null===t?this:this.getImmediateChild(t).getChild(fe(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if((0,o.hu)(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Ne(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const o=r.isEmpty()?et:this.priorityNode_;return new tt(r,o,i)}}updateChild(e,t){const n=de(e);if(null===n)return t;{(0,o.hu)(".priority"!==de(e)||1===pe(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(fe(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild($e,((o,s)=>{t[o]=s.val(e),n++,i&&tt.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+Ue(this.getPriority().val())+":"),this.forEachChild($e,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":y(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Ne(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ne(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ne(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Ne.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Ne.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===nt?-1:0}withIndex(e){if(e===Oe||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new tt(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Oe||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator($e),n=t.getIterator($e);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===Oe?null:this.indexMap_.get(e.toString())}}tt.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const nt=new class extends tt{constructor(){super(new Fe(je),tt.EMPTY_NODE,Ze.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return tt.EMPTY_NODE}isEmpty(){return!1}};function rt(e,t=null){if(null===e)return tt.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),(0,o.hu)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new Ye(e,rt(t));if(e instanceof Array){let n=tt.EMPTY_NODE;return L(e,((t,r)=>{if((0,o.r3)(e,t)&&"."!==t.substring(0,1)){const e=rt(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(rt(t))}{const n=[];let r=!1;if(L(e,((e,t)=>{if("."!==e.substring(0,1)){const i=rt(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Ne(e,i)))}})),0===n.length)return tt.EMPTY_NODE;const i=Qe(n,qe,(e=>e.name),je);if(r){const e=Qe(n,$e.getCompare());return new tt(i,rt(t),new Ze({".priority":e},{".priority":$e}))}return new tt(i,rt(t),Ze.Default)}}Object.defineProperties(Ne,{MIN:{value:new Ne(P,tt.EMPTY_NODE)},MAX:{value:new Ne(N,nt)}}),Ae.__EMPTY_NODE=tt.EMPTY_NODE,Ye.__childrenNodeConstructor=tt,ze=nt,Ve=nt,function(e){He=e}(rt);class it extends De{constructor(e){super(),this.indexPath_=e,(0,o.hu)(!ve(e)&&".priority"!==de(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?D(e.name,t.name):i}makePost(e,t){const n=rt(e),r=tt.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ne(t,r)}maxPost(){const e=tt.EMPTY_NODE.updateChild(this.indexPath_,nt);return new Ne(N,e)}toString(){return me(this.indexPath_,0).join("/")}}const ot=new class extends De{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?D(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ne.MIN}maxPost(){return Ne.MAX}makePost(e,t){const n=rt(e);return new Ne(t,n)}toString(){return".value"}},st="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",at=function(){let e=0;const t=[];return function(n){const r=n===e;let i;e=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=st.charAt(n%64),n=Math.floor(n/64);(0,o.hu)(0===n,"Cannot push at time == 0");let a=s.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)a+=st.charAt(t[i]);return(0,o.hu)(20===a.length,"nextPushId: Length should be 20."),a}}(),lt=function(e){if("2147483647"===e)return"-";const t=j(e);if(null!=t)return""+(t+1);const n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e.charAt(t);if(n.length<786)return n.push("-"),n.join("");let r=n.length-1;for(;r>=0&&"z"===n[r];)r--;if(-1===r)return N;const i=n[r],o=st.charAt(st.indexOf(i)+1);return n[r]=o,n.slice(0,r+1).join("")},ct=function(e){if("-2147483648"===e)return P;const t=j(e);if(null!=t)return""+(t-1);const n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e.charAt(t);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=st.charAt(st.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function ut(e){return{type:"value",snapshotNode:e}}function ht(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function dt(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function pt(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class ft{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){(0,o.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(dt(t,a)):(0,o.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(ht(t,n)):s.trackChildChange(pt(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild($e,((e,r)=>{t.hasChild(e)||n.trackChildChange(dt(e,r))})),t.isLeafNode()||t.forEachChild($e,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(pt(t,r,i))}else n.trackChildChange(ht(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?tt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class _t{constructor(e){this.indexedFilter_=new ft(e.getIndex()),this.index_=e.getIndex(),this.startPost_=_t.getStartPost_(e),this.endPost_=_t.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,n,r,i,o){return this.matches(new Ne(t,n))||(n=tt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)}updateFullNode(e,t,n){t.isLeafNode()&&(t=tt.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(tt.EMPTY_NODE);const i=this;return t.forEachChild($e,((e,t)=>{i.matches(new Ne(e,t))||(r=r.updateImmediateChild(e,tt.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class mt{constructor(e){this.rangedFilter_=new _t(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,n,r,i,o){return this.rangedFilter_.matches(new Ne(t,n))||(n=tt.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=tt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=tt.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();let i;if(i=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),t)<=0:this.index_.compare(t,this.rangedFilter_.getEndPost())<=0,!i)break;r=r.updateImmediateChild(t.name,t.node),n++}}else{let e,n,i,o;if(r=t.withIndex(this.index_),r=r.updatePriority(tt.EMPTY_NODE),this.reverse_){o=r.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),n=this.rangedFilter_.getStartPost();const t=this.index_.getCompare();i=(e,n)=>t(n,e)}else o=r.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),n=this.rangedFilter_.getEndPost(),i=this.index_.getCompare();let s=0,a=!1;for(;o.hasNext();){const t=o.getNext();!a&&i(e,t)<=0&&(a=!0),a&&s<this.limit_&&i(t,n)<=0?s++:r=r.updateImmediateChild(t.name,tt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const a=e;(0,o.hu)(a.numChildren()===this.limit_,"");const l=new Ne(t,n),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(t)){const e=a.getImmediateChild(t);let o=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=o&&(o.name===t||a.hasChild(o.name));)o=r.getChildAfterChild(this.index_,o,this.reverse_);const h=null==o?1:s(o,l);if(u&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(pt(t,n,e)),a.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(dt(t,e));const n=a.updateImmediateChild(t,tt.EMPTY_NODE);return null!=o&&this.rangedFilter_.matches(o)?(null!=i&&i.trackChildChange(ht(o.name,o.node)),n.updateImmediateChild(o.name,o.node)):n}}return n.isEmpty()?e:u&&s(c,l)>=0?(null!=i&&(i.trackChildChange(dt(c.name,c.node)),i.trackChildChange(ht(t,n))),a.updateImmediateChild(t,n).updateImmediateChild(c.name,tt.EMPTY_NODE)):e}}class gt{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=$e}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:P}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:N}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,o.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===$e}copy(){const e=new gt;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function yt(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function vt(e,t,n){const r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function wt(e,t){const n=e.copy();return n.index_=t,n}function bt(e){const t={};if(e.isDefault())return t;let n;return e.index_===$e?n="$priority":e.index_===ot?n="$value":e.index_===Oe?n="$key":((0,o.hu)(e.index_ instanceof it,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=(0,o.Pz)(n),e.startSet_&&(t.startAt=(0,o.Pz)(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+(0,o.Pz)(e.indexStartName_))),e.endSet_&&(t.endAt=(0,o.Pz)(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+(0,o.Pz)(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Ct(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==$e&&(t.i=e.index_.toString()),t}class kt extends ae{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=x("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,o.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=kt.getListenId_(e,n),a={};this.listens_[s]=a;const l=bt(e._queryParams);this.restRequest_(i+".json",l,((e,t)=>{let l=t;if(404===e&&(l=null,e=null),null===e&&this.onDataUpdate_(i,l,!1,n),(0,o.DV)(this.listens_,s)===a){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=kt.getListenId_(e,t);delete this.listens_[n]}get(e){const t=bt(e._queryParams),n=e._path.toString(),r=new o.BH;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,o.xO)(t);this.log_("Sending REST request for "+s);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(n&&4===a.readyState){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let e=null;if(a.status>=200&&a.status<300){try{e=(0,o.cI)(a.responseText)}catch(e){I("Failed to parse JSON response for "+s+": "+a.responseText)}n(null,e)}else 401!==a.status&&404!==a.status&&I("Got unsuccessful REST response for "+s+" Status: "+a.status),n(a.status);n=null}},a.open("GET",s,!0),a.send()}))}}class xt{constructor(){this.rootNode_=tt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Et(){return{value:null,children:new Map}}function Tt(e,t,n){if(ve(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=de(t);e.children.has(r)||e.children.set(r,Et()),Tt(e.children.get(r),t=fe(t),n)}}function It(e,t){if(ve(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild($e,((t,n)=>{Tt(e,new ue(t),n)})),It(e,t)}}if(e.children.size>0){const n=de(t);return t=fe(t),e.children.has(n)&&It(e.children.get(n),t)&&e.children.delete(n),0===e.children.size}return!0}function St(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{St(r,new ue(t.toString()+"/"+e),n)}))}class Pt{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&L(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class Nt{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Pt(e);const n=1e4+2e4*Math.random();U(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;L(e,((e,r)=>{r>0&&(0,o.r3)(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),U(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Dt;function Rt(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Dt||(Dt={}));class At{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Dt.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(ve(this.path)){if(null!=this.affectedTree.value)return(0,o.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new ue(e));return new At(he(),t,this.revert)}}return(0,o.hu)(de(this.path)===e,"operationForChild called for unrelated child."),new At(fe(this.path),this.affectedTree,this.revert)}}class Ot{constructor(e,t){this.source=e,this.path=t,this.type=Dt.LISTEN_COMPLETE}operationForChild(e){return ve(this.path)?new Ot(this.source,he()):new Ot(this.source,fe(this.path))}}class Mt{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Dt.OVERWRITE}operationForChild(e){return ve(this.path)?new Mt(this.source,he(),this.snap.getImmediateChild(e)):new Mt(this.source,fe(this.path),this.snap)}}class Lt{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Dt.MERGE}operationForChild(e){if(ve(this.path)){const t=this.children.subtree(new ue(e));return t.isEmpty()?null:t.value?new Mt(this.source,he(),t.value):new Lt(this.source,he(),t)}return(0,o.hu)(de(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Lt(this.source,fe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Ft{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ve(e))return this.isFullyInitialized()&&!this.filtered_;const t=de(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class qt{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function jt(e,t,n,r,i,s){const a=r.filter((e=>e.type===n));a.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw(0,o.g5)("Should only compare child_ events.");const r=new Ne(t.childName,t.snapshotNode),i=new Ne(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n))),a.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function zt(e,t){return{eventCache:e,serverCache:t}}function Ut(e,t,n,r){return zt(new Ft(t,n,r),e.serverCache)}function Wt(e,t,n,r){return zt(e.eventCache,new Ft(t,n,r))}function Bt(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Ht(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Vt;class Yt{constructor(e,t=(()=>(Vt||(Vt=new Fe(R)),Vt))()){this.value=e,this.children=t}static fromObject(e){let t=new Yt(null);return L(e,((e,n)=>{t=t.set(new ue(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:he(),value:this.value};if(ve(e))return null;{const n=de(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(fe(e),t);return null!=i?{path:ye(new ue(n),i.path),value:i.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(ve(e))return this;{const t=de(e),n=this.children.get(t);return null!==n?n.subtree(fe(e)):new Yt(null)}}set(e,t){if(ve(e))return new Yt(t,this.children);{const n=de(e),r=(this.children.get(n)||new Yt(null)).set(fe(e),t),i=this.children.insert(n,r);return new Yt(this.value,i)}}remove(e){if(ve(e))return this.children.isEmpty()?new Yt(null):new Yt(null,this.children);{const t=de(e),n=this.children.get(t);if(n){const r=n.remove(fe(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new Yt(null):new Yt(this.value,i)}return this}}get(e){if(ve(e))return this.value;{const t=de(e),n=this.children.get(t);return n?n.get(fe(e)):null}}setTree(e,t){if(ve(e))return t;{const n=de(e),r=(this.children.get(n)||new Yt(null)).setTree(fe(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new Yt(this.value,i)}}fold(e){return this.fold_(he(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(ye(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,he(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(ve(e))return null;{const r=de(e),i=this.children.get(r);return i?i.findOnPath_(fe(e),ye(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,he(),t)}foreachOnPath_(e,t,n){if(ve(e))return this;{this.value&&n(t,this.value);const r=de(e),i=this.children.get(r);return i?i.foreachOnPath_(fe(e),ye(t,r),n):new Yt(null)}}foreach(e){this.foreach_(he(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(ye(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class $t{constructor(e){this.writeTree_=e}static empty(){return new $t(new Yt(null))}}function Kt(e,t,n){if(ve(t))return new $t(new Yt(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let o=r.value;const s=we(i,t);return o=o.updateChild(s,n),new $t(e.writeTree_.set(i,o))}{const r=new Yt(n),i=e.writeTree_.setTree(t,r);return new $t(i)}}}function Gt(e,t,n){let r=e;return L(n,((e,n)=>{r=Kt(r,ye(t,e),n)})),r}function Qt(e,t){if(ve(t))return $t.empty();{const n=e.writeTree_.setTree(t,new Yt(null));return new $t(n)}}function Jt(e,t){return null!=Xt(e,t)}function Xt(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(we(n.path,t)):null}function Zt(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild($e,((e,n)=>{t.push(new Ne(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Ne(e,n.value))})),t}function en(e,t){if(ve(t))return e;{const n=Xt(e,t);return new $t(null!=n?new Yt(n):e.writeTree_.subtree(t))}}function tn(e){return e.writeTree_.isEmpty()}function nn(e,t){return rn(he(),e.writeTree_,t)}function rn(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?((0,o.hu)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=rn(ye(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(ye(e,".priority"),r)),n}}function on(e,t){return mn(t,e)}function sn(e,t){if(e.snap)return ke(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&ke(ye(e.path,n),t))return!0;return!1}function an(e){return e.visible}function ln(e,t,n){let r=$t.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)ke(n,e)?(t=we(n,e),r=Kt(r,t,s.snap)):ke(e,n)&&(t=we(e,n),r=Kt(r,he(),s.snap.getChild(t)));else{if(!s.children)throw(0,o.g5)("WriteRecord should have .snap or .children");if(ke(n,e))t=we(n,e),r=Gt(r,t,s.children);else if(ke(e,n))if(t=we(e,n),ve(t))r=Gt(r,he(),s.children);else{const e=(0,o.DV)(s.children,de(t));if(e){const n=e.getChild(fe(t));r=Kt(r,he(),n)}}}}}return r}function cn(e,t,n,r,i){if(r||i){const o=en(e.visibleWrites,t);if(!i&&tn(o))return n;if(i||null!=n||Jt(o,he())){const o=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(ke(e.path,t)||ke(t,e.path))};return nn(ln(e.allWrites,o,t),n||tt.EMPTY_NODE)}return null}{const r=Xt(e.visibleWrites,t);if(null!=r)return r;{const r=en(e.visibleWrites,t);return tn(r)?n:null!=n||Jt(r,he())?nn(r,n||tt.EMPTY_NODE):null}}}function un(e,t,n,r){return cn(e.writeTree,e.treePath,t,n,r)}function hn(e,t){return function(e,t,n){let r=tt.EMPTY_NODE;const i=Xt(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild($e,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=en(e.visibleWrites,t);return n.forEachChild($e,((e,t)=>{const n=nn(en(i,new ue(e)),t);r=r.updateImmediateChild(e,n)})),Zt(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return Zt(en(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function dn(e,t,n,r){return function(e,t,n,r,i){(0,o.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=ye(t,n);if(Jt(e.visibleWrites,s))return null;{const t=en(e.visibleWrites,s);return tn(t)?i.getChild(n):nn(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function pn(e,t){return function(e,t){return Xt(e.visibleWrites,t)}(e.writeTree,ye(e.treePath,t))}function fn(e,t,n){return function(e,t,n,r){const i=ye(t,n),o=Xt(e.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?nn(en(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function _n(e,t){return mn(ye(e.treePath,t),e.writeTree)}function mn(e,t){return{treePath:e,writeTree:t}}class gn{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;(0,o.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,o.hu)(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,pt(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,dt(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,ht(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw(0,o.g5)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,pt(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const yn=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class vn{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Ft(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return fn(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ht(this.viewCache_),i=function(e,t,n,r,i,o){return function(e,t,n,r,i,o,s){let a;const l=en(e.visibleWrites,t),c=Xt(l,he());if(null!=c)a=c;else{if(null==n)return[];a=nn(l,n)}if(a=a.withIndex(s),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=s.getCompare(),n=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s);let l=n.getNext();for(;l&&e.length<i;)0!==t(l,r)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,o)}(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function wn(e,t,n,r,i,s){const a=t.eventCache;if(null!=pn(r,n))return t;{let l,c;if(ve(n))if((0,o.hu)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Ht(t),i=hn(r,n instanceof tt?n:tt.EMPTY_NODE);l=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=un(r,Ht(t));l=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const u=de(n);if(".priority"===u){(0,o.hu)(1===pe(n),"Can't have a priority with additional path components");const i=a.getNode();c=t.serverCache.getNode();const s=dn(r,n,i,c);l=null!=s?e.filter.updatePriority(i,s):a.getNode()}else{const o=fe(n);let h;if(a.isCompleteForChild(u)){c=t.serverCache.getNode();const e=dn(r,n,a.getNode(),c);h=null!=e?a.getNode().getImmediateChild(u).updateChild(o,e):a.getNode().getImmediateChild(u)}else h=fn(r,u,t.serverCache);l=null!=h?e.filter.updateChild(a.getNode(),u,h,o,i,s):a.getNode()}}return Ut(t,l,a.isFullyInitialized()||ve(n),e.filter.filtersNodes())}}function bn(e,t,n,r,i,o,s,a){const l=t.serverCache;let c;const u=s?e.filter:e.filter.getIndexedFilter();if(ve(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),e,null)}else{const e=de(n);if(!l.isCompleteForPath(n)&&pe(n)>1)return t;const i=fe(n),o=l.getNode().getImmediateChild(e).updateChild(i,r);c=".priority"===e?u.updatePriority(l.getNode(),o):u.updateChild(l.getNode(),e,o,i,yn,null)}const h=Wt(t,c,l.isFullyInitialized()||ve(n),u.filtersNodes());return wn(e,h,n,i,new vn(i,h,o),a)}function Cn(e,t,n,r,i,o,s){const a=t.eventCache;let l,c;const u=new vn(i,t,o);if(ve(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,s),l=Ut(t,c,!0,e.filter.filtersNodes());else{const i=de(n);if(".priority"===i)c=e.filter.updatePriority(t.eventCache.getNode(),r),l=Ut(t,c,a.isFullyInitialized(),a.isFiltered());else{const o=fe(n),c=a.getNode().getImmediateChild(i);let h;if(ve(o))h=r;else{const e=u.getCompleteChild(i);h=null!=e?".priority"===_e(o)&&e.getChild(ge(o)).isEmpty()?e:e.updateChild(o,r):tt.EMPTY_NODE}l=c.equals(h)?t:Ut(t,e.filter.updateChild(a.getNode(),i,h,o,u,s),a.isFullyInitialized(),e.filter.filtersNodes())}}return l}function kn(e,t){return e.eventCache.isCompleteForChild(t)}function xn(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function En(e,t,n,r,i,o,s,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=ve(n)?r:new Yt(null).setTree(n,r);const u=t.serverCache.getNode();return l.children.inorderTraversal(((n,r)=>{if(u.hasChild(n)){const l=xn(0,t.serverCache.getNode().getImmediateChild(n),r);c=bn(e,c,new ue(n),l,i,o,s,a)}})),l.children.inorderTraversal(((n,r)=>{const l=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!u.hasChild(n)&&!l){const l=xn(0,t.serverCache.getNode().getImmediateChild(n),r);c=bn(e,c,new ue(n),l,i,o,s,a)}})),c}class Tn{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new ft(n.getIndex()),i=(o=n).loadsAllData()?new ft(o.getIndex()):o.hasLimit()?new mt(o):new _t(o);var o;this.processor_=function(e){return{filter:e}}(i);const s=t.serverCache,a=t.eventCache,l=r.updateFullNode(tt.EMPTY_NODE,s.getNode(),null),c=i.updateFullNode(tt.EMPTY_NODE,a.getNode(),null),u=new Ft(l,s.isFullyInitialized(),r.filtersNodes()),h=new Ft(c,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=zt(h,u),this.eventGenerator_=new qt(this.query_)}get query(){return this.query_}}function In(e,t){const n=Ht(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!ve(t)&&!n.getImmediateChild(de(t)).isEmpty())?n.getChild(t):null}function Sn(e){return 0===e.eventRegistrations_.length}function Pn(e,t,n){const r=[];if(n){(0,o.hu)(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function Nn(e,t,n,r){t.type===Dt.MERGE&&null!==t.source.queryId&&((0,o.hu)(Ht(e.viewCache_),"We should always have a full cache before handling merges"),(0,o.hu)(Bt(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=function(e,t,n,r,i){const s=new gn;let a,l;if(n.type===Dt.OVERWRITE){const c=n;c.source.fromUser?a=Cn(e,t,c.path,c.snap,r,i,s):((0,o.hu)(c.source.fromServer,"Unknown source."),l=c.source.tagged||t.serverCache.isFiltered()&&!ve(c.path),a=bn(e,t,c.path,c.snap,r,i,l,s))}else if(n.type===Dt.MERGE){const c=n;c.source.fromUser?a=function(e,t,n,r,i,o,s){let a=t;return r.foreach(((r,l)=>{const c=ye(n,r);kn(t,de(c))&&(a=Cn(e,a,c,l,i,o,s))})),r.foreach(((r,l)=>{const c=ye(n,r);kn(t,de(c))||(a=Cn(e,a,c,l,i,o,s))})),a}(e,t,c.path,c.children,r,i,s):((0,o.hu)(c.source.fromServer,"Unknown source."),l=c.source.tagged||t.serverCache.isFiltered(),a=En(e,t,c.path,c.children,r,i,l,s))}else if(n.type===Dt.ACK_USER_WRITE){const l=n;a=l.revert?function(e,t,n,r,i,s){let a;if(null!=pn(r,n))return t;{const l=new vn(r,t,i),c=t.eventCache.getNode();let u;if(ve(n)||".priority"===de(n)){let n;if(t.serverCache.isFullyInitialized())n=un(r,Ht(t));else{const e=t.serverCache.getNode();(0,o.hu)(e instanceof tt,"serverChildren would be complete if leaf node"),n=hn(r,e)}n=n,u=e.filter.updateFullNode(c,n,s)}else{const i=de(n);let o=fn(r,i,t.serverCache);null==o&&t.serverCache.isCompleteForChild(i)&&(o=c.getImmediateChild(i)),u=null!=o?e.filter.updateChild(c,i,o,fe(n),l,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(c,i,tt.EMPTY_NODE,fe(n),l,s):c,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=un(r,Ht(t)),a.isLeafNode()&&(u=e.filter.updateFullNode(u,a,s)))}return a=t.serverCache.isFullyInitialized()||null!=pn(r,he()),Ut(t,u,a,e.filter.filtersNodes())}}(e,t,l.path,r,i,s):function(e,t,n,r,i,o,s){if(null!=pn(i,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=r.value){if(ve(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return bn(e,t,n,l.getNode().getChild(n),i,o,a,s);if(ve(n)){let r=new Yt(null);return l.getNode().forEachChild(Oe,((e,t)=>{r=r.set(new ue(e),t)})),En(e,t,n,r,i,o,a,s)}return t}{let c=new Yt(null);return r.foreach(((e,t)=>{const r=ye(n,e);l.isCompleteForPath(r)&&(c=c.set(e,l.getNode().getChild(r)))})),En(e,t,n,c,i,o,a,s)}}(e,t,l.path,l.affectedTree,r,i,s)}else{if(n.type!==Dt.LISTEN_COMPLETE)throw(0,o.g5)("Unknown operation type: "+n.type);a=function(e,t,n,r,i){const o=t.serverCache;return wn(e,Wt(t,o.getNode(),o.isFullyInitialized()||ve(n),o.isFiltered()),n,r,yn,i)}(e,t,n.path,r,s)}const c=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Bt(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(ut(Bt(t)))}}(t,a,c),{viewCache:a,changes:c}}(e.processor_,i,t,n,r);var a,l;return a=e.processor_,l=s.viewCache,(0,o.hu)(l.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),(0,o.hu)(l.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),(0,o.hu)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,Dn(e,s.changes,s.viewCache.eventCache.getNode(),null)}function Dn(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],o=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),jt(e,i,"child_removed",t,r,n),jt(e,i,"child_added",t,r,n),jt(e,i,"child_moved",o,r,n),jt(e,i,"child_changed",t,r,n),jt(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let Rn,An;class On{constructor(){this.views=new Map}}function Mn(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return(0,o.hu)(null!=s,"SyncTree gave us an op for an invalid query."),Nn(s,t,n,r)}{let i=[];for(const o of e.views.values())i=i.concat(Nn(o,t,n,r));return i}}function Ln(e,t,n,r,i){const o=t._queryIdentifier,s=e.views.get(o);if(!s){let e=un(n,i?r:null),o=!1;e?o=!0:r instanceof tt?(e=hn(n,r),o=!1):(e=tt.EMPTY_NODE,o=!1);const s=zt(new Ft(e,o,!1),new Ft(r,i,!1));return new Tn(t,s)}return s}function Fn(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function qn(e,t){let n=null;for(const r of e.views.values())n=n||In(r,t);return n}function jn(e,t){if(t._queryParams.loadsAllData())return Wn(e);{const n=t._queryIdentifier;return e.views.get(n)}}function zn(e,t){return null!=jn(e,t)}function Un(e){return null!=Wn(e)}function Wn(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Bn=1;class Hn{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Yt(null),this.pendingWriteTree_={visibleWrites:$t.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Vn(e,t,n,r,i){return function(e,t,n,r,i){(0,o.hu)(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Kt(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?Jn(e,new Mt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Yn(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));(0,o.hu)(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,a=e.allWrites.length-1;for(;i&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=n&&sn(t,r.path)?i=!1:ke(r.path,t.path)&&(s=!0)),a--}return!!i&&(s?(function(e){e.visibleWrites=ln(e.allWrites,an,he()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0):(r.snap?e.visibleWrites=Qt(e.visibleWrites,r.path):L(r.children,(t=>{e.visibleWrites=Qt(e.visibleWrites,ye(r.path,t))})),!0))}(e.pendingWriteTree_,t)){let t=new Yt(null);return null!=r.snap?t=t.set(he(),!0):L(r.children,(e=>{t=t.set(new ue(e),!0)})),Jn(e,new At(r.path,t,n))}return[]}function $n(e,t,n){return Jn(e,new Mt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Kn(e,t,n,r){const i=t._path,s=e.syncPointTree_.get(i);let a=[];if(s&&("default"===t._queryIdentifier||zn(s,t))){const l=function(e,t,n,r){const i=t._queryIdentifier,s=[];let a=[];const l=Un(e);if("default"===i)for(const[t,i]of e.views.entries())a=a.concat(Pn(i,n,r)),Sn(i)&&(e.views.delete(t),i.query._queryParams.loadsAllData()||s.push(i.query));else{const t=e.views.get(i);t&&(a=a.concat(Pn(t,n,r)),Sn(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||s.push(t.query)))}return l&&!Un(e)&&s.push(new((0,o.hu)(Rn,"Reference.ts has not been loaded"),Rn)(t._repo,t._path)),{removed:s,events:a}}(s,t,n,r);0===s.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));const c=l.removed;a=l.events;const u=-1!==c.findIndex((e=>e._queryParams.loadsAllData())),h=e.syncPointTree_.findOnPath(i,((e,t)=>Un(t)));if(u&&!h){const t=e.syncPointTree_.subtree(i);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&Un(t))return[Wn(t)];{let e=[];return t&&(e=Fn(t)),L(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,o=er(e,r);e.listenProvider_.startListening(sr(i),tr(e,i),o.hashFn,o.onComplete)}}}if(!h&&c.length>0&&!r)if(u){const n=null;e.listenProvider_.stopListening(sr(t),n)}else c.forEach((t=>{const n=e.queryToTagMap.get(nr(t));e.listenProvider_.stopListening(sr(t),n)}));!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=nr(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return a}function Gn(e,t,n){const r=t._path;let i=null,s=!1;e.syncPointTree_.foreachOnPath(r,((e,t)=>{const n=we(e,r);i=i||qn(t,n),s=s||Un(t)}));let a,l=e.syncPointTree_.get(r);l?(s=s||Un(l),i=i||qn(l,he())):(l=new On,e.syncPointTree_=e.syncPointTree_.set(r,l)),null!=i?a=!0:(a=!1,i=tt.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild(((e,t)=>{const n=qn(t,he());n&&(i=i.updateImmediateChild(e,n))})));const c=zn(l,t);if(!c&&!t._queryParams.loadsAllData()){const n=nr(t);(0,o.hu)(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=Bn++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=function(e,t,n,r,i,o){const s=Ln(e,t,r,i,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,s),function(e,t){e.eventRegistrations_.push(t)}(s,n),function(e,t){const n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild($e,((e,t)=>{r.push(ht(e,t))})),n.isFullyInitialized()&&r.push(ut(n.getNode())),Dn(e,r,n.getNode(),t)}(s,n)}(l,t,n,on(e.pendingWriteTree_,r),i,a);if(!c&&!s){const n=jn(l,t);u=u.concat(function(e,t,n){const r=t._path,i=tr(e,t),s=er(e,n),a=e.listenProvider_.startListening(sr(t),i,s.hashFn,s.onComplete),l=e.syncPointTree_.subtree(r);if(i)(0,o.hu)(!Un(l.value),"If we're adding a query, it shouldn't be shadowed");else{const t=l.fold(((e,t,n)=>{if(!ve(e)&&t&&Un(t))return[Wn(t).query];{let e=[];return t&&(e=e.concat(Fn(t).map((e=>e.query)))),L(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(sr(r),tr(e,r))}}return a}(e,t,n))}return u}function Qn(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=qn(n,we(e,t));if(r)return r}));return cn(r,t,i,n,!0)}function Jn(e,t){return Xn(t,e.syncPointTree_,null,on(e.pendingWriteTree_,he()))}function Xn(e,t,n,r){if(ve(e.path))return Zn(e,t,n,r);{const i=t.get(he());null==n&&null!=i&&(n=qn(i,he()));let o=[];const s=de(e.path),a=e.operationForChild(s),l=t.children.get(s);if(l&&a){const e=n?n.getImmediateChild(s):null,t=_n(r,s);o=o.concat(Xn(a,l,e,t))}return i&&(o=o.concat(Mn(i,e,r,n))),o}}function Zn(e,t,n,r){const i=t.get(he());null==n&&null!=i&&(n=qn(i,he()));let o=[];return t.children.inorderTraversal(((t,i)=>{const s=n?n.getImmediateChild(t):null,a=_n(r,t),l=e.operationForChild(t);l&&(o=o.concat(Zn(l,i,s,a)))})),i&&(o=o.concat(Mn(i,e,r,n))),o}function er(e,t){const n=t.query,r=tr(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||tt.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=rr(e,n);if(r){const n=ir(r),i=n.path,o=n.queryId,s=we(i,t);return or(e,i,new Ot(Rt(o),s))}return[]}(e,n._path,r):function(e,t){return Jn(e,new Ot({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return Kn(e,n,null,r)}}}}function tr(e,t){const n=nr(t);return e.queryToTagMap.get(n)}function nr(e){return e._path.toString()+"$"+e._queryIdentifier}function rr(e,t){return e.tagToQueryMap.get(t)}function ir(e){const t=e.indexOf("$");return(0,o.hu)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new ue(e.substr(0,t))}}function or(e,t,n){const r=e.syncPointTree_.get(t);return(0,o.hu)(r,"Missing sync point for query tag that we're tracking"),Mn(r,n,on(e.pendingWriteTree_,t),null)}function sr(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new((0,o.hu)(An,"Reference.ts has not been loaded"),An)(e._repo,e._path):e}class ar{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new ar(t)}node(){return this.node_}}class lr{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=ye(this.path_,e);return new lr(this.syncTree_,t)}node(){return Qn(this.syncTree_,this.path_)}}const cr=function(e,t,n){return e&&"object"==typeof e?((0,o.hu)(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?ur(e[".sv"],t,n):"object"==typeof e[".sv"]?hr(e[".sv"],t):void(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},ur=function(e,t,n){if("timestamp"===e)return n.timestamp;(0,o.hu)(!1,"Unexpected server value: "+e)},hr=function(e,t,n){e.hasOwnProperty("increment")||(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&(0,o.hu)(!1,"Unexpected increment value: "+r);const i=t.node();if((0,o.hu)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!=typeof s?r:s+r},dr=function(e,t,n,r){return fr(t,new lr(n,e),r)},pr=function(e,t,n){return fr(e,new ar(t),n)};function fr(e,t,n){const r=e.getPriority().val(),i=cr(r,t.getImmediateChild(".priority"),n);let o;if(e.isLeafNode()){const r=e,o=cr(r.getValue(),t,n);return o!==r.getValue()||i!==r.getPriority().val()?new Ye(o,rt(i)):e}{const r=e;return o=r,i!==r.getPriority().val()&&(o=o.updatePriority(new Ye(i))),r.forEachChild($e,((e,r)=>{const i=fr(r,t.getImmediateChild(e),n);i!==r&&(o=o.updateImmediateChild(e,i))})),o}}class _r{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function mr(e,t){let n=t instanceof ue?t:new ue(t),r=e,i=de(n);for(;null!==i;){const e=(0,o.DV)(r.node.children,i)||{children:{},childCount:0};r=new _r(i,r,e),n=fe(n),i=de(n)}return r}function gr(e){return e.node.value}function yr(e,t){e.node.value=t,kr(e)}function vr(e){return e.node.childCount>0}function wr(e,t){L(e.node.children,((n,r)=>{t(new _r(n,e,r))}))}function br(e,t,n,r){n&&!r&&t(e),wr(e,(e=>{br(e,t,!0,r)})),n&&r&&t(e)}function Cr(e){return new ue(null===e.parent?e.name:Cr(e.parent)+"/"+e.name)}function kr(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===gr(e)&&!vr(e)}(n),i=(0,o.r3)(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,kr(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,kr(e))}(e.parent,e.name,e)}const xr=/[\[\].#$\/\u0000-\u001F\u007F]/,Er=/[\[\].#$\u0000-\u001F\u007F]/,Tr=10485760,Ir=function(e){return"string"==typeof e&&0!==e.length&&!xr.test(e)},Sr=function(e){return"string"==typeof e&&0!==e.length&&!Er.test(e)},Pr=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!S(e)||e&&"object"==typeof e&&(0,o.r3)(e,".sv")},Nr=function(e,t,n,r){r&&void 0===t||Dr((0,o.gK)(e,"value"),t,n)},Dr=function(e,t,n){const r=n instanceof ue?new xe(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Te(r));if("function"==typeof t)throw new Error(e+"contains a function "+Te(r)+" with contents = "+t.toString());if(S(t))throw new Error(e+"contains "+t.toString()+" "+Te(r));if("string"==typeof t&&t.length>Tr/3&&(0,o.ug)(t)>Tr)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+Te(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(L(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!Ir(t)))throw new Error(e+" contains an invalid key ("+t+") "+Te(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=(0,o.ug)(t),Ee(e)}(r,t),Dr(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=(0,o.ug)(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+Te(r)+" in addition to actual children.")}},Rr=function(e,t,n,r){if(r&&void 0===t)return;const i=(0,o.gK)(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];L(t,((e,t)=>{const r=new ue(e);if(Dr(i,t,ye(n,r)),".priority"===_e(r)&&!Pr(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=me(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!Ir(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(be);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&ke(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},Ar=function(e,t,n){if(!n||void 0!==t){if(S(t))throw new Error((0,o.gK)(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Pr(t))throw new Error((0,o.gK)(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Or=function(e,t,n,r){if(!(r&&void 0===n||Ir(n)))throw new Error((0,o.gK)(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Mr=function(e,t,n,r){if(!(r&&void 0===n||Sr(n)))throw new Error((0,o.gK)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Lr=function(e,t){if(".info"===de(t))throw new Error(e+" failed = Can't modify data under /.info/")},Fr=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Ir(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Sr(e)}(n))throw new Error((0,o.gK)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class qr{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function jr(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],o=i.getPath();null===n||Ce(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function zr(e,t,n){jr(e,n),Wr(e,(e=>Ce(e,t)))}function Ur(e,t,n){jr(e,n),Wr(e,(e=>ke(e,t)||ke(t,e)))}function Wr(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];i&&(t(i.path)?(Br(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}function Br(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();w&&k("event: "+n.toString()),z(r)}}}const Hr="repo_interrupt";class Vr{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new qr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Et(),this.transactionQueueTree_=new _r,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Yr(e,t,n){if(e.stats_=Z(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new kt(e.repoInfo_,((t,n,r,i)=>{Gr(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>Qr(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,o.Pz)(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Pe(e.repoInfo_,t,((t,n,r,i)=>{Gr(e,t,n,r,i)}),(t=>{Qr(e,t)}),(t=>{!function(e,t){L(t,((t,n)=>{Jr(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(t,n){const r=t.toString();return X[r]||(X[r]=new Nt(e.stats_,e.server_)),X[r]}(e.repoInfo_),e.infoData_=new xt,e.infoSyncTree_=new Hn({startListening:(t,n,r,i)=>{let o=[];const s=e.infoData_.getNode(t._path);return s.isEmpty()||(o=$n(e.infoSyncTree_,t._path,s),setTimeout((()=>{i("ok")}),0)),o},stopListening:()=>{}}),Jr(e,"connected",!1),e.serverSyncTree_=new Hn({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const o=i(n,r);Ur(e.eventQueue_,t._path,o)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function $r(e){const t=e.infoData_.getNode(new ue(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Kr(e){return(t=(t={timestamp:$r(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function Gr(e,t,n,r,i){e.dataUpdateCount++;const s=new ue(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let a=[];if(i)if(r){const t=(0,o.UI)(n,(e=>rt(e)));a=function(e,t,n,r){const i=rr(e,r);if(i){const r=ir(i),o=r.path,s=r.queryId,a=we(o,t),l=Yt.fromObject(n);return or(e,o,new Lt(Rt(s),a,l))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=rt(n);a=function(e,t,n,r){const i=rr(e,r);if(null!=i){const r=ir(i),o=r.path,s=r.queryId,a=we(o,t);return or(e,o,new Mt(Rt(s),a,n))}return[]}(e.serverSyncTree_,s,t,i)}else if(r){const t=(0,o.UI)(n,(e=>rt(e)));a=function(e,t,n){const r=Yt.fromObject(n);return Jn(e,new Lt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=rt(n);a=$n(e.serverSyncTree_,s,t)}let l=s;a.length>0&&(l=li(e,s)),Ur(e.eventQueue_,l,a)}function Qr(e,t){Jr(e,"connected",t),!1===t&&function(e){ii(e,"onDisconnectEvents");const t=Kr(e),n=Et();St(e.onDisconnect_,he(),((r,i)=>{const o=dr(r,i,e.serverSyncTree_,t);Tt(n,r,o)}));let r=[];St(n,he(),((t,n)=>{r=r.concat($n(e.serverSyncTree_,t,n));const i=pi(e,t);li(e,i)})),e.onDisconnect_=Et(),Ur(e.eventQueue_,he(),r)}(e)}function Jr(e,t,n){const r=new ue("/.info/"+t),i=rt(n);e.infoData_.updateSnapshot(r,i);const o=$n(e.infoSyncTree_,r,i);Ur(e.eventQueue_,r,o)}function Xr(e){return e.nextWriteId_++}function Zr(e,t,n,r,i){ii(e,"set",{path:t.toString(),value:n,priority:r});const o=Kr(e),s=rt(n,r),a=Qn(e.serverSyncTree_,t),l=pr(s,a,o),c=Xr(e),u=Vn(e.serverSyncTree_,t,l,c,!0);jr(e.eventQueue_,u),e.server_.put(t.toString(),s.val(!0),((n,r)=>{const o="ok"===n;o||I("set at "+t+" failed: "+n);const s=Yn(e.serverSyncTree_,c,!o);Ur(e.eventQueue_,t,s),oi(0,i,n,r)}));const h=pi(e,t);li(e,h),Ur(e.eventQueue_,h,[])}function ei(e,t,n){e.server_.onDisconnectCancel(t.toString(),((r,i)=>{"ok"===r&&It(e.onDisconnect_,t),oi(0,n,r,i)}))}function ti(e,t,n,r){const i=rt(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),((n,o)=>{"ok"===n&&Tt(e.onDisconnect_,t,i),oi(0,r,n,o)}))}function ni(e,t,n){let r;r=".info"===de(t._path)?Kn(e.infoSyncTree_,t,n):Kn(e.serverSyncTree_,t,n),zr(e.eventQueue_,t._path,r)}function ri(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Hr)}function ii(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),k(n,...t)}function oi(e,t,n,r){t&&z((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const o=new Error(i);o.code=e,t(o)}}))}function si(e,t,n){return Qn(e.serverSyncTree_,t,n)||tt.EMPTY_NODE}function ai(e,t=e.transactionQueueTree_){if(t||di(e,t),gr(t)){const n=ui(e,t);(0,o.hu)(n.length>0,"Sending zero length transaction queue"),n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=si(e,t,r);let s=i;const a=i.hash();for(let e=0;e<n.length;e++){const r=n[e];(0,o.hu)(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=we(t,r.path);s=s.updateChild(i,r.currentOutputSnapshotRaw)}const l=s.val(!0),c=t;e.server_.put(c.toString(),l,(r=>{ii(e,"transaction put response",{path:c.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(Yn(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();di(e,mr(e.transactionQueueTree_,t)),ai(e,e.transactionQueueTree_),Ur(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)z(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{I("transaction at "+c.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}li(e,t)}}),a)}(e,Cr(t),n)}else vr(t)&&wr(t,(t=>{ai(e,t)}))}function li(e,t){const n=ci(e,t),r=Cr(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let l=0;l<t.length;l++){const c=t[l],u=we(n,c.path);let h,d=!1;if((0,o.hu)(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)d=!0,h=c.abortReason,i=i.concat(Yn(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)d=!0,h="maxretry",i=i.concat(Yn(e.serverSyncTree_,c.currentWriteId,!0));else{const n=si(e,c.path,s);c.currentInputSnapshot=n;const r=t[l].update(n.val());if(void 0!==r){Dr("transaction failed: Data returned ",r,c.path);let t=rt(r);"object"==typeof r&&null!=r&&(0,o.r3)(r,".priority")||(t=t.updatePriority(n.getPriority()));const a=c.currentWriteId,l=Kr(e),u=pr(t,n,l);c.currentOutputSnapshotRaw=t,c.currentOutputSnapshotResolved=u,c.currentWriteId=Xr(e),s.splice(s.indexOf(a),1),i=i.concat(Vn(e.serverSyncTree_,c.path,u,c.currentWriteId,c.applyLocally)),i=i.concat(Yn(e.serverSyncTree_,a,!0))}else d=!0,h="nodata",i=i.concat(Yn(e.serverSyncTree_,c.currentWriteId,!0))}Ur(e.eventQueue_,n,i),i=[],d&&(t[l].status=2,a=t[l].unwatcher,setTimeout(a,Math.floor(0)),t[l].onComplete&&("nodata"===h?r.push((()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot))):r.push((()=>t[l].onComplete(new Error(h),!1,null)))))}var a;di(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)z(r[e]);ai(e,e.transactionQueueTree_)}(e,ui(e,n),r),r}function ci(e,t){let n,r=e.transactionQueueTree_;for(n=de(t);null!==n&&void 0===gr(r);)r=mr(r,n),n=de(t=fe(t));return r}function ui(e,t){const n=[];return hi(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function hi(e,t,n){const r=gr(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);wr(t,(t=>{hi(e,t,n)}))}function di(e,t){const n=gr(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,yr(t,n.length>0?n:void 0)}wr(t,(t=>{di(e,t)}))}function pi(e,t){const n=Cr(ci(e,t)),r=mr(e.transactionQueueTree_,t);return function(e,t,n){let r=e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{fi(e,t)})),fi(e,r),br(r,(t=>{fi(e,t)})),n}function fi(e,t){const n=gr(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?((0,o.hu)(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):((0,o.hu)(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(Yn(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?yr(t,void 0):n.length=s+1,Ur(e.eventQueue_,Cr(t),i);for(let e=0;e<r.length;e++)z(r[e])}}const _i=function(e,t){const n=mi(e),r=n.namespace;"firebase.com"===n.domain&&T(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||T("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&I("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new K(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new ue(n.pathString)}},mi=function(e){let t="",n="",r="",i="",o="",s=!0,a="https",l=443;if("string"==typeof e){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):I(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(s="https"===a||"wss"===a,l=parseInt(t.substring(c+1),10)):c=t.length;const p=t.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),o=r}"ns"in d&&(o=d.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};class gi{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,o.Pz)(this.snapshot.exportVal())}}class yi{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class vi{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,o.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class wi{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new o.BH;return ei(this._repo,this._path,e.wrapCallback((()=>{}))),e.promise}remove(){Lr("OnDisconnect.remove",this._path);const e=new o.BH;return ti(this._repo,this._path,null,e.wrapCallback((()=>{}))),e.promise}set(e){Lr("OnDisconnect.set",this._path),Nr("OnDisconnect.set",e,this._path,!1);const t=new o.BH;return ti(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}setWithPriority(e,t){Lr("OnDisconnect.setWithPriority",this._path),Nr("OnDisconnect.setWithPriority",e,this._path,!1),Ar("OnDisconnect.setWithPriority",t,!1);const n=new o.BH;return function(e,t,n,r,i){const o=rt(n,r);e.server_.onDisconnectPut(t.toString(),o.val(!0),((n,r)=>{"ok"===n&&Tt(e.onDisconnect_,t,o),oi(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((()=>{}))),n.promise}update(e){Lr("OnDisconnect.update",this._path),Rr("OnDisconnect.update",e,this._path,!1);const t=new o.BH;return function(e,t,n,r){if((0,o.xb)(n))return k("onDisconnect().update() called with empty data.  Don't do anything."),void oi(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,((i,o)=>{"ok"===i&&L(n,((n,r)=>{const i=rt(r);Tt(e.onDisconnect_,ye(t,n),i)})),oi(0,r,i,o)}))}(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}}class bi{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return ve(this._path)?null:_e(this._path)}get ref(){return new Ei(this._repo,this._path)}get _queryIdentifier(){const e=Ct(this._queryParams),t=O(e);return"{}"===t?"default":t}get _queryObject(){return Ct(this._queryParams)}isEqual(e){if(!((e=(0,o.m9)(e))instanceof bi))return!1;const t=this._repo===e._repo,n=Ce(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function Ci(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function ki(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Oe){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==P)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==N)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===$e){if(null!=t&&!Pr(t)||null!=n&&!Pr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,o.hu)(e.getIndex()instanceof it||e.getIndex()===ot,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function xi(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Ei extends bi{constructor(e,t){super(e,t,new gt,!1)}get parent(){const e=ge(this._path);return null===e?null:new Ei(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Ti{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new ue(e),n=Pi(this.ref,e);return new Ti(this._node.getChild(t),n,$e)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,((t,n)=>e(new Ti(n,Pi(this.ref,t),$e))))}hasChild(e){const t=new ue(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ii(e,t){return(e=(0,o.m9)(e))._checkNotDeleted("ref"),void 0!==t?Pi(e._root,t):e._root}function Si(e,t){(e=(0,o.m9)(e))._checkNotDeleted("refFromURL");const n=_i(t,e._repo.repoInfo_.nodeAdmin);Fr("refFromURL",n);const r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||T("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),Ii(e,n.path.toString())}function Pi(e,t){var n;return null===de((e=(0,o.m9)(e))._path)?("child","path",!1,(n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Mr("child","path",n,false)):Mr("child","path",t,!1),new Ei(e._repo,ye(e._path,t))}function Ni(e){return e=(0,o.m9)(e),new wi(e._repo,e._path)}function Di(e,t){e=(0,o.m9)(e),Lr("push",e._path),Nr("push",t,e._path,!0);const n=$r(e._repo),r=at(n),i=Pi(e,r),s=Pi(e,r);let a;return a=null!=t?Ai(s,t).then((()=>s)):Promise.resolve(s),i.then=a.then.bind(a),i.catch=a.then.bind(a,void 0),i}function Ri(e){return Lr("remove",e._path),Ai(e,null)}function Ai(e,t){e=(0,o.m9)(e),Lr("set",e._path),Nr("set",t,e._path,!1);const n=new o.BH;return Zr(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function Oi(e,t){e=(0,o.m9)(e),Lr("setPriority",e._path),Ar("setPriority",t,!1);const n=new o.BH;return Zr(e._repo,ye(e._path,".priority"),t,null,n.wrapCallback((()=>{}))),n.promise}function Mi(e,t,n){if(Lr("setWithPriority",e._path),Nr("setWithPriority",t,e._path,!1),Ar("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const r=new o.BH;return Zr(e._repo,e._path,t,n,r.wrapCallback((()=>{}))),r.promise}function Li(e,t){Rr("update",t,e._path,!1);const n=new o.BH;return function(e,t,n,r){ii(e,"update",{path:t.toString(),value:n});let i=!0;const s=Kr(e),a={};if(L(n,((n,r)=>{i=!1,a[n]=dr(ye(t,n),rt(r),e.serverSyncTree_,s)})),i)k("update() called with empty data.  Don't do anything."),oi(0,r,"ok",void 0);else{const i=Xr(e),s=function(e,t,n,r){!function(e,t,n,r){(0,o.hu)(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Gt(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=Yt.fromObject(n);return Jn(e,new Lt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,t,a,i);jr(e.eventQueue_,s),e.server_.merge(t.toString(),n,((n,o)=>{const s="ok"===n;s||I("update at "+t+" failed: "+n);const a=Yn(e.serverSyncTree_,i,!s),l=a.length>0?li(e,t):t;Ur(e.eventQueue_,l,a),oi(0,r,n,o)})),L(n,(n=>{const r=pi(e,ye(t,n));li(e,r)})),Ur(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function Fi(e){return function(e,t){const n=function(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=we(e,n);r=r||qn(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||qn(i,he()):(i=new On,e.syncPointTree_=e.syncPointTree_.set(n,i));const o=null!=r,s=o?new Ft(r,!0,!1):null;return Bt(Ln(i,t,on(e.pendingWriteTree_,t._path),o?s.getNode():tt.EMPTY_NODE,o).viewCache_)}(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then((n=>{const r=rt(n).withIndex(t._queryParams.getIndex()),i=$n(e.serverSyncTree_,t._path,r);return zr(e.eventQueue_,t._path,i),Promise.resolve(r)}),(n=>(ii(e,"get for query "+(0,o.Pz)(t)+" failed: "+n),Promise.reject(new Error(n)))))}((e=(0,o.m9)(e))._repo,e).then((t=>new Ti(t,new Ei(e._repo,e._path),e._queryParams.getIndex())))}class qi{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new gi("value",this,new Ti(e.snapshotNode,new Ei(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new yi(this,e,t):null}matches(e){return e instanceof qi&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class ji{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new yi(this,e,t):null}createEvent(e,t){(0,o.hu)(null!=e.childName,"Child events should have a childName.");const n=Pi(new Ei(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new gi(e.type,this,new Ti(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof ji&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function zi(e,t,n,r,i){let o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{ni(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const s=new vi(n,o||void 0),a="value"===t?new qi(s):new ji(t,s);return function(e,t,n){let r;r=".info"===de(t._path)?Gn(e.infoSyncTree_,t,n):Gn(e.serverSyncTree_,t,n),zr(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>ni(e._repo,e,a)}function Ui(e,t,n,r){return zi(e,"value",t,n,r)}function Wi(e,t,n,r){return zi(e,"child_added",t,n,r)}function Bi(e,t,n,r){return zi(e,"child_changed",t,n,r)}function Hi(e,t,n,r){return zi(e,"child_moved",t,n,r)}function Vi(e,t,n,r){return zi(e,"child_removed",t,n,r)}function Yi(e,t,n){let r=null;const i=n?new vi(n):null;"value"===t?r=new qi(i):t&&(r=new ji(t,i)),ni(e._repo,e,r)}class $i{}class Ki extends $i{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Nr("endAt",this._value,e._path,!0);const t=vt(e._queryParams,this._value,this._key);if(xi(t),ki(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)}}function Gi(e,t){return Or("endAt","key",t,!0),new Ki(e,t)}class Qi extends $i{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Nr("endBefore",this._value,e._path,!1);const t=function(e,t,n){let r,i;return e.index_===Oe?("string"==typeof t&&(t=ct(t)),i=vt(e,t,n)):(r=null==n?P:ct(n),i=vt(e,t,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(xi(t),ki(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)}}function Ji(e,t){return Or("endBefore","key",t,!0),new Qi(e,t)}class Xi extends $i{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Nr("startAt",this._value,e._path,!0);const t=yt(e._queryParams,this._value,this._key);if(xi(t),ki(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)}}function Zi(e=null,t){return Or("startAt","key",t,!0),new Xi(e,t)}class eo extends $i{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Nr("startAfter",this._value,e._path,!1);const t=function(e,t,n){let r;if(e.index_===Oe)"string"==typeof t&&(t=lt(t)),r=yt(e,t,n);else{let i;i=null==n?N:lt(n),r=yt(e,t,i)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(xi(t),ki(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)}}function to(e,t){return Or("startAfter","key",t,!0),new eo(e,t)}class no extends $i{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new bi(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}function ro(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new no(e)}class io extends $i{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new bi(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}function oo(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new io(e)}class so extends $i{constructor(e){super(),this._path=e}_apply(e){Ci(e,"orderByChild");const t=new ue(this._path);if(ve(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new it(t),r=wt(e._queryParams,n);return ki(r),new bi(e._repo,e._path,r,!0)}}function ao(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Mr("orderByChild","path",e,!1),new so(e)}class lo extends $i{_apply(e){Ci(e,"orderByKey");const t=wt(e._queryParams,Oe);return ki(t),new bi(e._repo,e._path,t,!0)}}function co(){return new lo}class uo extends $i{_apply(e){Ci(e,"orderByPriority");const t=wt(e._queryParams,$e);return ki(t),new bi(e._repo,e._path,t,!0)}}function ho(){return new uo}class po extends $i{_apply(e){Ci(e,"orderByValue");const t=wt(e._queryParams,ot);return ki(t),new bi(e._repo,e._path,t,!0)}}function fo(){return new po}class _o extends $i{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(Nr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Ki(this._value,this._key)._apply(new Xi(this._value,this._key)._apply(e))}}function mo(e,t){return Or("equalTo","key",t,!0),new _o(e,t)}function go(e,...t){let n=(0,o.m9)(e);for(const e of t)n=e._apply(n);return n}!function(e){(0,o.hu)(!Rn,"__referenceConstructor has already been defined"),Rn=e}(Ei),function(e){(0,o.hu)(!An,"__referenceConstructor has already been defined"),An=e}(Ei);const yo={};let vo=!1;function wo(e,t,n,r,i){let o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||T("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),k("Using default host for project ",e.options.projectId),o=`${e.options.projectId}-default-rtdb.firebaseio.com`);let s,a,l=_i(o,i),c=l.repoInfo;"undefined"!=typeof process&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(s=!0,o=`http://${a}?ns=${c.namespace}`,l=_i(o,i),c=l.repoInfo):s=!l.repoInfo.secure;const u=i&&s?new H(H.OWNER):new B(e.name,e.options,t);Fr("Invalid Firebase Database URL",l),ve(l.path)||T("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=yo[t.name];i||(i={},yo[t.name]=i);let o=i[e.toURLString()];return o&&T("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Vr(e,vo,n,r),i[e.toURLString()]=o,o}(c,e,u,new W(e.name,n));return new bo(h,e)}class bo{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Yr(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ei(this._repo,he())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const n=yo[t];n&&n[e.key]===e||T(`Database ${t}(${e.repoInfo_}) has already been deleted.`),ri(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&T("Cannot call "+e+" on a deleted database.")}}function Co(e=(0,r.Mq)(),t){return(0,r.qX)(e,"database").getImmediate({identifier:t})}function ko(e,t,n,r={}){(e=(0,o.m9)(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&T("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&T('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new H(H.OWNER);else if(r.mockUserToken){const t="string"==typeof r.mockUserToken?r.mockUserToken:(0,o.Sg)(r.mockUserToken,e.app.options.projectId);s=new H(t)}!function(e,t,n,r){e.repoInfo_=new K(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(i,t,n,s)}function xo(e){(e=(0,o.m9)(e))._checkNotDeleted("goOffline"),ri(e._repo)}function Eo(e){var t;(e=(0,o.m9)(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(Hr)}function To(e,t){C(e,t)}const Io={".sv":"timestamp"};function So(){return Io}function Po(e){return{".sv":{increment:e}}}class No{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function Do(e,t,n){var r;if(e=(0,o.m9)(e),Lr("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,s=new o.BH,a=Ui(e,(()=>{}));return function(t,n,r,i,a,l){ii(t,"transaction on "+n);const c={path:n,update:r,onComplete:(t,n,r)=>{let i=null;t?s.reject(t):(i=new Ti(r,new Ei(e._repo,e._path),$e),s.resolve(new No(n,i)))},status:null,order:g(),applyLocally:l,retryCount:0,unwatcher:a,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=si(t,n,void 0);c.currentInputSnapshot=u;const h=c.update(u.val());if(void 0===h)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Dr("transaction failed: Data returned ",h,c.path),c.status=0;const e=mr(t.transactionQueueTree_,n),r=gr(e)||[];let i;r.push(c),yr(e,r),"object"==typeof h&&null!==h&&(0,o.r3)(h,".priority")?(i=(0,o.DV)(h,".priority"),(0,o.hu)(Pr(i),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):i=(Qn(t.serverSyncTree_,n)||tt.EMPTY_NODE).getPriority().val();const s=Kr(t),a=rt(h,i),l=pr(a,u,s);c.currentOutputSnapshotRaw=a,c.currentOutputSnapshotResolved=l,c.currentWriteId=Xr(t);const d=Vn(t.serverSyncTree_,n,l,c.currentWriteId,c.applyLocally);Ur(t.eventQueue_,n,d),ai(t,t.transactionQueueTree_)}}(e._repo,e._path,t,0,a,i),s.promise}Pe.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Pe.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};const Ro=function(e){const t=Pe.prototype.put;return Pe.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){Pe.prototype.put=t}},Ao=function(e){!function(e){vo=e}(e)};u(r.Jn),(0,r.Xd)(new i.wA("database",((e,{instanceIdentifier:t})=>wo(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),(0,r.KN)(a,l,undefined),(0,r.KN)(a,l,"esm2017")},8018:(e,t,n)=>{"use strict";var r=n(8178);e.exports=function(e,t,n){var i=[],o=!1,s=!1;function a(){if(o)throw new Error("Nested m.redraw.sync() call");o=!0;for(var t=0;t<i.length;t+=2)try{e(i[t],r(i[t+1]),l)}catch(e){n.error(e)}o=!1}function l(){s||(s=!0,t((function(){s=!1,a()})))}return l.sync=a,{mount:function(t,n){if(null!=n&&null==n.view&&"function"!=typeof n)throw new TypeError("m.mount(element, component) expects a component, not a vnode");var o=i.indexOf(t);o>=0&&(i.splice(o,2),e(t,[],l)),null!=n&&(i.push(t,n),e(t,r(n),l))},redraw:l}}},3223:(e,t,n)=>{"use strict";var r=n(8178),i=n(373),o=n(5164),s=n(249),a=n(8561),l=n(7562),c=n(1127),u={};e.exports=function(e,t){var n;function h(t,r,i){if(t=s(t,r),null!=n){n();var o=i?i.state:null,a=i?i.title:null;i&&i.replace?e.history.replaceState(o,a,y.prefix+t):e.history.pushState(o,a,y.prefix+t)}else e.location.href=y.prefix+t}var d,p,f,_,m=u,g=y.SKIP={};function y(i,s,v){if(null==i)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var w,b=0,C=Object.keys(v).map((function(e){if("/"!==e[0])throw new SyntaxError("Routes must start with a `/`");if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Route parameter names must be separated with either `/`, `.`, or `-`");return{route:e,component:v[e],check:l(e)}})),k="function"==typeof setImmediate?setImmediate:setTimeout,x=o.resolve(),E=!1;if(n=null,null!=s){var T=a(s);if(!C.some((function(e){return e.check(T)})))throw new ReferenceError("Default route doesn't match any known routes")}function I(){E=!1;var n=e.location.hash;"#"!==y.prefix[0]&&(n=e.location.search+n,"?"!==y.prefix[0]&&"/"!==(n=e.location.pathname+n)[0]&&(n="/"+n));var r=n.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent).slice(y.prefix.length),i=a(r);function o(){if(r===s)throw new Error("Could not resolve default route "+s);h(s,null,{replace:!0})}c(i.params,e.history.state),function e(n){for(;n<C.length;n++)if(C[n].check(i)){var s=C[n].component,a=C[n].route,l=s,c=_=function(o){if(c===_){if(o===g)return e(n+1);d=null==o||"function"!=typeof o.view&&"function"!=typeof o?"div":o,p=i.params,f=r,_=null,m=s.render?s:null,2===b?t.redraw():(b=2,t.redraw.sync())}};return void(s.view||"function"==typeof s?(s={},c(l)):s.onmatch?x.then((function(){return s.onmatch(i.params,r,a)})).then(c,o):c("div"))}o()}(0)}return n=function(){E||(E=!0,k(I))},"function"==typeof e.history.pushState?(w=function(){e.removeEventListener("popstate",n,!1)},e.addEventListener("popstate",n,!1)):"#"===y.prefix[0]&&(n=null,w=function(){e.removeEventListener("hashchange",I,!1)},e.addEventListener("hashchange",I,!1)),t.mount(i,{onbeforeupdate:function(){return!(!(b=b?2:1)||u===m)},oncreate:I,onremove:w,view:function(){if(b&&u!==m){var e=[r(d,p.key,p)];return m&&(e=m.render(e[0])),e}}})}return y.set=function(e,t,n){null!=_&&((n=n||{}).replace=!0),_=null,h(e,t,n)},y.get=function(){return f},y.prefix="#!",y.Link={view:function(e){var t,n,r=e.attrs.options,o={};c(o,e.attrs),o.selector=o.options=o.key=o.oninit=o.oncreate=o.onbeforeupdate=o.onupdate=o.onbeforeremove=o.onremove=null;var s=i(e.attrs.selector||"a",o,e.children);return(s.attrs.disabled=Boolean(s.attrs.disabled))?(s.attrs.href=null,s.attrs["aria-disabled"]="true",s.attrs.onclick=null):(t=s.attrs.onclick,n=s.attrs.href,s.attrs.href=y.prefix+n,s.attrs.onclick=function(e){var i;"function"==typeof t?i=t.call(e.currentTarget,e):null==t||"object"!=typeof t||"function"==typeof t.handleEvent&&t.handleEvent(e),!1===i||e.defaultPrevented||0!==e.button&&0!==e.which&&1!==e.which||e.currentTarget.target&&"_self"!==e.currentTarget.target||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(e.preventDefault(),e.redraw=!1,y.set(n,null,r))}),s}},y.param=function(e){return p&&null!=e?p[e]:p},y}},1262:(e,t,n)=>{"use strict";var r=n(373);r.trust=n(4742),r.fragment=n(9621),e.exports=r},865:(e,t,n)=>{"use strict";var r=n(1262),i=n(9074),o=n(9165),s=function(){return r.apply(this,arguments)};s.m=r,s.trust=r.trust,s.fragment=r.fragment,s.mount=o.mount,s.route=n(843),s.render=n(5358),s.redraw=o.redraw,s.request=i.request,s.jsonp=i.jsonp,s.parseQueryString=n(9874),s.buildQueryString=n(478),s.parsePathname=n(8561),s.buildPathname=n(249),s.vnode=n(8178),s.PromisePolyfill=n(2803),e.exports=s},9165:(e,t,n)=>{"use strict";var r=n(5358);e.exports=n(8018)(r,requestAnimationFrame,console)},1127:e=>{"use strict";e.exports=Object.assign||function(e,t){t&&Object.keys(t).forEach((function(n){e[n]=t[n]}))}},249:(e,t,n)=>{"use strict";var r=n(478),i=n(1127);e.exports=function(e,t){if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Template parameter names *must* be separated");if(null==t)return e;var n=e.indexOf("?"),o=e.indexOf("#"),s=o<0?e.length:o,a=n<0?s:n,l=e.slice(0,a),c={};i(c,t);var u=l.replace(/:([^\/\.-]+)(\.{3})?/g,(function(e,n,r){return delete c[n],null==t[n]?e:r?t[n]:encodeURIComponent(String(t[n]))})),h=u.indexOf("?"),d=u.indexOf("#"),p=d<0?u.length:d,f=h<0?p:h,_=u.slice(0,f);n>=0&&(_+=e.slice(n,s)),h>=0&&(_+=(n<0?"?":"&")+u.slice(h,p));var m=r(c);return m&&(_+=(n<0&&h<0?"?":"&")+m),o>=0&&(_+=e.slice(o)),d>=0&&(_+=(o<0?"":"&")+u.slice(d)),_}},7562:(e,t,n)=>{"use strict";var r=n(8561);e.exports=function(e){var t=r(e),n=Object.keys(t.params),i=[],o=new RegExp("^"+t.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,(function(e,t,n){return null==t?"\\"+e:(i.push({k:t,r:"..."===n}),"..."===n?"(.*)":"."===n?"([^/]+)\\.":"([^/]+)"+(n||""))}))+"$");return function(e){for(var r=0;r<n.length;r++)if(t.params[n[r]]!==e.params[n[r]])return!1;if(!i.length)return o.test(e.path);var s=o.exec(e.path);if(null==s)return!1;for(r=0;r<i.length;r++)e.params[i[r].k]=i[r].r?s[r+1]:decodeURIComponent(s[r+1]);return!0}}},8561:(e,t,n)=>{"use strict";var r=n(9874);e.exports=function(e){var t=e.indexOf("?"),n=e.indexOf("#"),i=n<0?e.length:n,o=t<0?i:t,s=e.slice(0,o).replace(/\/{2,}/g,"/");return s?("/"!==s[0]&&(s="/"+s),s.length>1&&"/"===s[s.length-1]&&(s=s.slice(0,-1))):s="/",{path:s,params:t<0?{}:r(e.slice(t+1,i))}}},2803:e=>{"use strict";var t=function(e){if(!(this instanceof t))throw new Error("Promise must be called with `new`");if("function"!=typeof e)throw new TypeError("executor must be a function");var n=this,r=[],i=[],o=c(r,!0),s=c(i,!1),a=n._instance={resolvers:r,rejectors:i},l="function"==typeof setImmediate?setImmediate:setTimeout;function c(e,t){return function o(c){var h;try{if(!t||null==c||"object"!=typeof c&&"function"!=typeof c||"function"!=typeof(h=c.then))l((function(){t||0!==e.length||console.error("Possible unhandled promise rejection:",c);for(var n=0;n<e.length;n++)e[n](c);r.length=0,i.length=0,a.state=t,a.retry=function(){o(c)}}));else{if(c===n)throw new TypeError("Promise can't be resolved w/ itself");u(h.bind(c))}}catch(e){s(e)}}}function u(e){var t=0;function n(e){return function(n){t++>0||e(n)}}var r=n(s);try{e(n(o),r)}catch(e){r(e)}}u(e)};t.prototype.then=function(e,n){var r,i,o=this._instance;function s(e,t,n,s){t.push((function(t){if("function"!=typeof e)n(t);else try{r(e(t))}catch(e){i&&i(e)}})),"function"==typeof o.retry&&s===o.state&&o.retry()}var a=new t((function(e,t){r=e,i=t}));return s(e,o.resolvers,r,!0),s(n,o.rejectors,i,!1),a},t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(e){return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))},t.resolve=function(e){return e instanceof t?e:new t((function(t){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.all=function(e){return new t((function(t,n){var r=e.length,i=0,o=[];if(0===e.length)t([]);else for(var s=0;s<e.length;s++)!function(s){function a(e){i++,o[s]=e,i===r&&t(o)}null==e[s]||"object"!=typeof e[s]&&"function"!=typeof e[s]||"function"!=typeof e[s].then?a(e[s]):e[s].then(a,n)}(s)}))},t.race=function(e){return new t((function(t,n){for(var r=0;r<e.length;r++)e[r].then(t,n)}))},e.exports=t},5164:(e,t,n)=>{"use strict";var r=n(2803);"undefined"!=typeof window?(void 0===window.Promise?window.Promise=r:window.Promise.prototype.finally||(window.Promise.prototype.finally=r.prototype.finally),e.exports=window.Promise):void 0!==n.g?(void 0===n.g.Promise?n.g.Promise=r:n.g.Promise.prototype.finally||(n.g.Promise.prototype.finally=r.prototype.finally),e.exports=n.g.Promise):e.exports=r},478:e=>{"use strict";e.exports=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t=[];for(var n in e)r(n,e[n]);return t.join("&");function r(e,n){if(Array.isArray(n))for(var i=0;i<n.length;i++)r(e+"["+i+"]",n[i]);else if("[object Object]"===Object.prototype.toString.call(n))for(var i in n)r(e+"["+i+"]",n[i]);else t.push(encodeURIComponent(e)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}}},9874:e=>{"use strict";e.exports=function(e){if(""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));for(var t=e.split("&"),n={},r={},i=0;i<t.length;i++){var o=t[i].split("="),s=decodeURIComponent(o[0]),a=2===o.length?decodeURIComponent(o[1]):"";"true"===a?a=!0:"false"===a&&(a=!1);var l=s.split(/\]\[?|\[/),c=r;s.indexOf("[")>-1&&l.pop();for(var u=0;u<l.length;u++){var h=l[u],d=l[u+1],p=""==d||!isNaN(parseInt(d,10));if(""===h)null==n[s=l.slice(0,u).join()]&&(n[s]=Array.isArray(c)?c.length:0),h=n[s]++;else if("__proto__"===h)break;if(u===l.length-1)c[h]=a;else{var f=Object.getOwnPropertyDescriptor(c,h);null!=f&&(f=f.value),null==f&&(c[h]=f=p?[]:{}),c=f}}}return r}},5358:(e,t,n)=>{"use strict";e.exports=n(5452)(window)},9621:(e,t,n)=>{"use strict";var r=n(8178),i=n(1359);e.exports=function(){var e=i.apply(0,arguments);return e.tag="[",e.children=r.normalizeChildren(e.children),e}},373:(e,t,n)=>{"use strict";var r=n(8178),i=n(1359),o=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,s={},a={}.hasOwnProperty;function l(e){for(var t in e)if(a.call(e,t))return!1;return!0}function c(e){for(var t,n="div",r=[],i={};t=o.exec(e);){var a=t[1],l=t[2];if(""===a&&""!==l)n=l;else if("#"===a)i.id=l;else if("."===a)r.push(l);else if("["===t[3][0]){var c=t[6];c&&(c=c.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===t[4]?r.push(c):i[t[4]]=""===c?c:c||!0}}return r.length>0&&(i.className=r.join(" ")),s[e]={tag:n,attrs:i}}function u(e,t){var n=t.attrs,i=r.normalizeChildren(t.children),o=a.call(n,"class"),s=o?n.class:n.className;if(t.tag=e.tag,t.attrs=null,t.children=void 0,!l(e.attrs)&&!l(n)){var c={};for(var u in n)a.call(n,u)&&(c[u]=n[u]);n=c}for(var u in e.attrs)a.call(e.attrs,u)&&"className"!==u&&!a.call(n,u)&&(n[u]=e.attrs[u]);for(var u in null==s&&null==e.attrs.className||(n.className=null!=s?null!=e.attrs.className?String(e.attrs.className)+" "+String(s):s:null!=e.attrs.className?e.attrs.className:null),o&&(n.class=null),n)if(a.call(n,u)&&"key"!==u){t.attrs=n;break}return Array.isArray(i)&&1===i.length&&null!=i[0]&&"#"===i[0].tag?t.text=i[0].children:t.children=i,t}e.exports=function(e){if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");var t=i.apply(1,arguments);return"string"==typeof e&&(t.children=r.normalizeChildren(t.children),"["!==e)?u(s[e]||c(e),t):(t.tag=e,t)}},1359:(e,t,n)=>{"use strict";var r=n(8178);e.exports=function(){var e,t=arguments[this],n=this+1;if(null==t?t={}:("object"!=typeof t||null!=t.tag||Array.isArray(t))&&(t={},n=this),arguments.length===n+1)e=arguments[n],Array.isArray(e)||(e=[e]);else for(e=[];n<arguments.length;)e.push(arguments[n++]);return r("",t.key,t,e)}},5452:(e,t,n)=>{"use strict";var r=n(8178);e.exports=function(e){var t,n=e&&e.document,i={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function o(e){return e.attrs&&e.attrs.xmlns||i[e.tag]}function s(e,t){if(e.state!==t)throw new Error("`vnode.state` must not be modified")}function a(e){var t=e.state;try{return this.apply(t,arguments)}finally{s(e,t)}}function l(){try{return n.activeElement}catch(e){return null}}function c(e,t,n,r,i,o,s){for(var a=n;a<r;a++){var l=t[a];null!=l&&u(e,l,i,s,o)}}function u(e,t,i,s,l){var h=t.tag;if("string"==typeof h)switch(t.state={},null!=t.attrs&&F(t.attrs,t,i),h){case"#":!function(e,t,r){t.dom=n.createTextNode(t.children),w(e,t.dom,r)}(e,t,l);break;case"<":d(e,t,s,l);break;case"[":!function(e,t,r,i,o){var s=n.createDocumentFragment();if(null!=t.children){var a=t.children;c(s,a,0,a.length,r,null,i)}t.dom=s.firstChild,t.domSize=s.childNodes.length,w(e,s,o)}(e,t,i,s,l);break;default:!function(e,t,i,s,a){var l=t.tag,u=t.attrs,h=u&&u.is,d=(s=o(t)||s)?h?n.createElementNS(s,l,{is:h}):n.createElementNS(s,l):h?n.createElement(l,{is:h}):n.createElement(l);if(t.dom=d,null!=u&&function(e,t,n){for(var r in t)I(e,r,null,t[r],n)}(t,u,s),w(e,d,a),!b(t)&&(null!=t.text&&(""!==t.text?d.textContent=t.text:t.children=[r("#",void 0,void 0,t.text,void 0,void 0)]),null!=t.children)){var p=t.children;c(d,p,0,p.length,i,null,s),"select"===t.tag&&null!=u&&function(e,t){if("value"in t)if(null===t.value)-1!==e.dom.selectedIndex&&(e.dom.value=null);else{var n=""+t.value;e.dom.value===n&&-1!==e.dom.selectedIndex||(e.dom.value=n)}"selectedIndex"in t&&I(e,"selectedIndex",null,t.selectedIndex,void 0)}(t,u)}}(e,t,i,s,l)}else!function(e,t,n,i,o){(function(e,t){var n;if("function"==typeof e.tag.view){if(e.state=Object.create(e.tag),null!=(n=e.state.view).$$reentrantLock$$)return;n.$$reentrantLock$$=!0}else{if(e.state=void 0,null!=(n=e.tag).$$reentrantLock$$)return;n.$$reentrantLock$$=!0,e.state=null!=e.tag.prototype&&"function"==typeof e.tag.prototype.view?new e.tag(e):e.tag(e)}if(F(e.state,e,t),null!=e.attrs&&F(e.attrs,e,t),e.instance=r.normalize(a.call(e.state.view,e)),e.instance===e)throw Error("A view cannot return the vnode it received as argument");n.$$reentrantLock$$=null})(t,n),null!=t.instance?(u(e,t.instance,n,i,o),t.dom=t.instance.dom,t.domSize=null!=t.dom?t.instance.domSize:0):t.domSize=0}(e,t,i,s,l)}var h={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function d(e,t,r,i){var o=t.children.match(/^\s*?<(\w+)/im)||[],s=n.createElement(h[o[1]]||"div");"http://www.w3.org/2000/svg"===r?(s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",s=s.firstChild):s.innerHTML=t.children,t.dom=s.firstChild,t.domSize=s.childNodes.length,t.instance=[];for(var a,l=n.createDocumentFragment();a=s.firstChild;)t.instance.push(a),l.appendChild(a);w(e,l,i)}function p(e,t,n,r,i,o){if(t!==n&&(null!=t||null!=n))if(null==t||0===t.length)c(e,n,0,n.length,r,i,o);else if(null==n||0===n.length)C(e,t,0,t.length);else{var s=null!=t[0]&&null!=t[0].key,a=null!=n[0]&&null!=n[0].key,l=0,h=0;if(!s)for(;h<t.length&&null==t[h];)h++;if(!a)for(;l<n.length&&null==n[l];)l++;if(null===a&&null==s)return;if(s!==a)C(e,t,h,t.length),c(e,n,l,n.length,r,i,o);else if(a){for(var d,p,v,w,b,x=t.length-1,E=n.length-1;x>=h&&E>=l&&(v=t[x],w=n[E],v.key===w.key);)v!==w&&f(e,v,w,r,i,o),null!=w.dom&&(i=w.dom),x--,E--;for(;x>=h&&E>=l&&(d=t[h],p=n[l],d.key===p.key);)h++,l++,d!==p&&f(e,d,p,r,g(t,h,i),o);for(;x>=h&&E>=l&&l!==E&&d.key===w.key&&v.key===p.key;)y(e,v,b=g(t,h,i)),v!==p&&f(e,v,p,r,b,o),++l<=--E&&y(e,d,i),d!==w&&f(e,d,w,r,i,o),null!=w.dom&&(i=w.dom),h++,v=t[--x],w=n[E],d=t[h],p=n[l];for(;x>=h&&E>=l&&v.key===w.key;)v!==w&&f(e,v,w,r,i,o),null!=w.dom&&(i=w.dom),E--,v=t[--x],w=n[E];if(l>E)C(e,t,h,x+1);else if(h>x)c(e,n,l,E+1,r,i,o);else{var T,I,S=i,P=E-l+1,N=new Array(P),D=0,R=0,A=2147483647,O=0;for(R=0;R<P;R++)N[R]=-1;for(R=E;R>=l;R--){null==T&&(T=_(t,h,x+1));var M=T[(w=n[R]).key];null!=M&&(A=M<A?M:-1,N[R-l]=M,v=t[M],t[M]=null,v!==w&&f(e,v,w,r,i,o),null!=w.dom&&(i=w.dom),O++)}if(i=S,O!==x-h+1&&C(e,t,h,x+1),0===O)c(e,n,l,E+1,r,i,o);else if(-1===A)for(I=function(e){var t=[0],n=0,r=0,i=0,o=m.length=e.length;for(i=0;i<o;i++)m[i]=e[i];for(i=0;i<o;++i)if(-1!==e[i]){var s=t[t.length-1];if(e[s]<e[i])m[i]=s,t.push(i);else{for(n=0,r=t.length-1;n<r;){var a=(n>>>1)+(r>>>1)+(n&r&1);e[t[a]]<e[i]?n=a+1:r=a}e[i]<e[t[n]]&&(n>0&&(m[i]=t[n-1]),t[n]=i)}}for(r=t[(n=t.length)-1];n-- >0;)t[n]=r,r=m[r];return m.length=0,t}(N),D=I.length-1,R=E;R>=l;R--)p=n[R],-1===N[R-l]?u(e,p,r,o,i):I[D]===R-l?D--:y(e,p,i),null!=p.dom&&(i=n[R].dom);else for(R=E;R>=l;R--)p=n[R],-1===N[R-l]&&u(e,p,r,o,i),null!=p.dom&&(i=n[R].dom)}}else{var L=t.length<n.length?t.length:n.length;for(l=l<h?l:h;l<L;l++)(d=t[l])===(p=n[l])||null==d&&null==p||(null==d?u(e,p,r,o,g(t,l+1,i)):null==p?k(e,d):f(e,d,p,r,g(t,l+1,i),o));t.length>L&&C(e,t,l,t.length),n.length>L&&c(e,n,l,n.length,r,i,o)}}}function f(e,t,n,i,s,l){var c=t.tag;if(c===n.tag){if(n.state=t.state,n.events=t.events,function(e,t){do{var n;if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate&&void 0!==(n=a.call(e.attrs.onbeforeupdate,e,t))&&!n)break;if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate&&void 0!==(n=a.call(e.state.onbeforeupdate,e,t))&&!n)break;return!1}while(0);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,!0}(n,t))return;if("string"==typeof c)switch(null!=n.attrs&&q(n.attrs,n,i),c){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children),t.dom=e.dom}(t,n);break;case"<":!function(e,t,n,r,i){t.children!==n.children?(x(e,t),d(e,n,r,i)):(n.dom=t.dom,n.domSize=t.domSize,n.instance=t.instance)}(e,t,n,l,s);break;case"[":!function(e,t,n,r,i,o){p(e,t.children,n.children,r,i,o);var s=0,a=n.children;if(n.dom=null,null!=a){for(var l=0;l<a.length;l++){var c=a[l];null!=c&&null!=c.dom&&(null==n.dom&&(n.dom=c.dom),s+=c.domSize||1)}1!==s&&(n.domSize=s)}}(e,t,n,i,s,l);break;default:!function(e,t,n,i){var s=t.dom=e.dom;i=o(t)||i,"textarea"===t.tag&&(null==t.attrs&&(t.attrs={}),null!=t.text&&(t.attrs.value=t.text,t.text=void 0)),function(e,t,n,r){if(null!=n)for(var i in n)I(e,i,t&&t[i],n[i],r);var o;if(null!=t)for(var i in t)null==(o=t[i])||null!=n&&null!=n[i]||S(e,i,o,r)}(t,e.attrs,t.attrs,i),b(t)||(null!=e.text&&null!=t.text&&""!==t.text?e.text.toString()!==t.text.toString()&&(e.dom.firstChild.nodeValue=t.text):(null!=e.text&&(e.children=[r("#",void 0,void 0,e.text,void 0,e.dom.firstChild)]),null!=t.text&&(t.children=[r("#",void 0,void 0,t.text,void 0,void 0)]),p(s,e.children,t.children,n,null,i)))}(t,n,i,l)}else!function(e,t,n,i,o,s){if(n.instance=r.normalize(a.call(n.state.view,n)),n.instance===n)throw Error("A view cannot return the vnode it received as argument");q(n.state,n,i),null!=n.attrs&&q(n.attrs,n,i),null!=n.instance?(null==t.instance?u(e,n.instance,i,s,o):f(e,t.instance,n.instance,i,o,s),n.dom=n.instance.dom,n.domSize=n.instance.domSize):null!=t.instance?(k(e,t.instance),n.dom=void 0,n.domSize=0):(n.dom=t.dom,n.domSize=t.domSize)}(e,t,n,i,s,l)}else k(e,t),u(e,n,i,l,s)}function _(e,t,n){for(var r=Object.create(null);t<n;t++){var i=e[t];if(null!=i){var o=i.key;null!=o&&(r[o]=t)}}return r}var m=[];function g(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function y(e,t,r){var i=n.createDocumentFragment();v(e,i,t),w(e,i,r)}function v(e,t,n){for(;null!=n.dom&&n.dom.parentNode===e;){if("string"!=typeof n.tag){if(null!=(n=n.instance))continue}else if("<"===n.tag)for(var r=0;r<n.instance.length;r++)t.appendChild(n.instance[r]);else if("["!==n.tag)t.appendChild(n.dom);else if(1===n.children.length){if(null!=(n=n.children[0]))continue}else for(r=0;r<n.children.length;r++){var i=n.children[r];null!=i&&v(e,t,i)}break}}function w(e,t,n){null!=n?e.insertBefore(t,n):e.appendChild(t)}function b(e){if(null==e.attrs||null==e.attrs.contenteditable&&null==e.attrs.contentEditable)return!1;var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=e.text||null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted");return!0}function C(e,t,n,r){for(var i=n;i<r;i++){var o=t[i];null!=o&&k(e,o)}}function k(e,t){var n,r,i,o=0,l=t.state;if("string"!=typeof t.tag&&"function"==typeof t.state.onbeforeremove&&null!=(i=a.call(t.state.onbeforeremove,t))&&"function"==typeof i.then&&(o=1,n=i),t.attrs&&"function"==typeof t.attrs.onbeforeremove&&null!=(i=a.call(t.attrs.onbeforeremove,t))&&"function"==typeof i.then&&(o|=2,r=i),s(t,l),o){if(null!=n){var c=function(){1&o&&((o&=2)||u())};n.then(c,c)}null!=r&&(c=function(){2&o&&((o&=1)||u())},r.then(c,c))}else T(t),E(e,t);function u(){s(t,l),T(t),E(e,t)}}function x(e,t){for(var n=0;n<t.instance.length;n++)e.removeChild(t.instance[n])}function E(e,t){for(;null!=t.dom&&t.dom.parentNode===e;){if("string"!=typeof t.tag){if(null!=(t=t.instance))continue}else if("<"===t.tag)x(e,t);else{if("["!==t.tag&&(e.removeChild(t.dom),!Array.isArray(t.children)))break;if(1===t.children.length){if(null!=(t=t.children[0]))continue}else for(var n=0;n<t.children.length;n++){var r=t.children[n];null!=r&&E(e,r)}}break}}function T(e){if("string"!=typeof e.tag&&"function"==typeof e.state.onremove&&a.call(e.state.onremove,e),e.attrs&&"function"==typeof e.attrs.onremove&&a.call(e.attrs.onremove,e),"string"!=typeof e.tag)null!=e.instance&&T(e.instance);else{var t=e.children;if(Array.isArray(t))for(var n=0;n<t.length;n++){var r=t[n];null!=r&&T(r)}}}function I(e,t,r,i,o){if("key"!==t&&"is"!==t&&null!=i&&!P(t)&&(r!==i||function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===l()||"option"===e.tag&&e.dom.parentNode===n.activeElement}(e,t)||"object"==typeof i)){if("o"===t[0]&&"n"===t[1])return L(e,t,i);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),i);else if("style"===t)O(e.dom,r,i);else if(N(e,t,o)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+i&&e.dom===l())return;if("select"===e.tag&&null!==r&&e.dom.value===""+i)return;if("option"===e.tag&&null!==r&&e.dom.value===""+i)return}"input"===e.tag&&"type"===t?e.dom.setAttribute(t,i):e.dom[t]=i}else"boolean"==typeof i?i?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,i)}}function S(e,t,n,r){if("key"!==t&&"is"!==t&&null!=n&&!P(t))if("o"!==t[0]||"n"!==t[1]||P(t))if("style"===t)O(e.dom,n,null);else if(!N(e,t,r)||"className"===t||"value"===t&&("option"===e.tag||"select"===e.tag&&-1===e.dom.selectedIndex&&e.dom===l())||"input"===e.tag&&"type"===t){var i=t.indexOf(":");-1!==i&&(t=t.slice(i+1)),!1!==n&&e.dom.removeAttribute("className"===t?"class":t)}else e.dom[t]=null;else L(e,t,void 0)}function P(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function N(e,t,n){return void 0===n&&(e.tag.indexOf("-")>-1||null!=e.attrs&&e.attrs.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}var D=/[A-Z]/g;function R(e){return"-"+e.toLowerCase()}function A(e){return"-"===e[0]&&"-"===e[1]?e:"cssFloat"===e?"float":e.replace(D,R)}function O(e,t,n){if(t===n);else if(null==n)e.style.cssText="";else if("object"!=typeof n)e.style.cssText=n;else if(null==t||"object"!=typeof t)for(var r in e.style.cssText="",n)null!=(i=n[r])&&e.style.setProperty(A(r),String(i));else{for(var r in n){var i;null!=(i=n[r])&&(i=String(i))!==String(t[r])&&e.style.setProperty(A(r),i)}for(var r in t)null!=t[r]&&null==n[r]&&e.style.removeProperty(A(r))}}function M(){this._=t}function L(e,t,n){if(null!=e.events){if(e.events[t]===n)return;null==n||"function"!=typeof n&&"object"!=typeof n?(null!=e.events[t]&&e.dom.removeEventListener(t.slice(2),e.events,!1),e.events[t]=void 0):(null==e.events[t]&&e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}else null==n||"function"!=typeof n&&"object"!=typeof n||(e.events=new M,e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}function F(e,t,n){"function"==typeof e.oninit&&a.call(e.oninit,t),"function"==typeof e.oncreate&&n.push(a.bind(e.oncreate,t))}function q(e,t,n){"function"==typeof e.onupdate&&n.push(a.bind(e.onupdate,t))}return M.prototype=Object.create(null),M.prototype.handleEvent=function(e){var t,n=this["on"+e.type];"function"==typeof n?t=n.call(e.currentTarget,e):"function"==typeof n.handleEvent&&n.handleEvent(e),this._&&!1!==e.redraw&&(0,this._)(),!1===t&&(e.preventDefault(),e.stopPropagation())},function(e,n,i){if(!e)throw new TypeError("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var o=[],s=l(),a=e.namespaceURI;null==e.vnodes&&(e.textContent=""),n=r.normalizeChildren(Array.isArray(n)?n:[n]);var c=t;try{t="function"==typeof i?i:void 0,p(e,e.vnodes,n,o,null,"http://www.w3.org/1999/xhtml"===a?void 0:a)}finally{t=c}e.vnodes=n,null!=s&&l()!==s&&"function"==typeof s.focus&&s.focus();for(var u=0;u<o.length;u++)o[u]()}}},4742:(e,t,n)=>{"use strict";var r=n(8178);e.exports=function(e){return null==e&&(e=""),r("<",void 0,void 0,e,void 0,void 0)}},8178:e=>{"use strict";function t(e,t,n,r,i,o){return{tag:e,key:t,attrs:n,children:r,text:i,dom:o,domSize:void 0,state:void 0,events:void 0,instance:void 0}}t.normalize=function(e){return Array.isArray(e)?t("[",void 0,void 0,t.normalizeChildren(e),void 0,void 0):null==e||"boolean"==typeof e?null:"object"==typeof e?e:t("#",void 0,void 0,String(e),void 0,void 0)},t.normalizeChildren=function(e){var n=[];if(e.length){for(var r=null!=e[0]&&null!=e[0].key,i=1;i<e.length;i++)if((null!=e[i]&&null!=e[i].key)!==r)throw new TypeError("Vnodes must either always have keys or never have keys!");for(i=0;i<e.length;i++)n[i]=t.normalize(e[i])}return n},e.exports=t},9074:(e,t,n)=>{"use strict";var r=n(5164),i=n(9165);e.exports=n(2775)(window,r,i.redraw)},2775:(e,t,n)=>{"use strict";var r=n(249);e.exports=function(e,t,n){var i=0;function o(e){return new t(e)}function s(e){return function(i,s){"string"!=typeof i?(s=i,i=i.url):null==s&&(s={});var a=new t((function(t,n){e(r(i,s.params),s,(function(e){if("function"==typeof s.type)if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=new s.type(e[n]);else e=new s.type(e);t(e)}),n)}));if(!0===s.background)return a;var l=0;function c(){0==--l&&"function"==typeof n&&n()}return function e(t){var n=t.then;return t.constructor=o,t.then=function(){l++;var r=n.apply(t,arguments);return r.then(c,(function(e){if(c(),0===l)throw e})),e(r)},t}(a)}}function a(e,t){for(var n in e.headers)if({}.hasOwnProperty.call(e.headers,n)&&t.test(n))return!0;return!1}return o.prototype=t.prototype,o.__proto__=t,{request:s((function(t,n,r,i){var o,s=null!=n.method?n.method.toUpperCase():"GET",l=n.body,c=!(null!=n.serialize&&n.serialize!==JSON.serialize||l instanceof e.FormData),u=n.responseType||("function"==typeof n.extract?"":"json"),h=new e.XMLHttpRequest,d=!1,p=h,f=h.abort;for(var _ in h.abort=function(){d=!0,f.call(this)},h.open(s,t,!1!==n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),c&&null!=l&&!a(n,/^content-type$/i)&&h.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof n.deserialize||a(n,/^accept$/i)||h.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(h.withCredentials=n.withCredentials),n.timeout&&(h.timeout=n.timeout),h.responseType=u,n.headers)({}).hasOwnProperty.call(n.headers,_)&&h.setRequestHeader(_,n.headers[_]);h.onreadystatechange=function(e){if(!d&&4===e.target.readyState)try{var o,s=e.target.status>=200&&e.target.status<300||304===e.target.status||/^file:\/\//i.test(t),a=e.target.response;if("json"===u?e.target.responseType||"function"==typeof n.extract||(a=JSON.parse(e.target.responseText)):u&&"text"!==u||null==a&&(a=e.target.responseText),"function"==typeof n.extract?(a=n.extract(e.target,n),s=!0):"function"==typeof n.deserialize&&(a=n.deserialize(a)),s)r(a);else{try{o=e.target.responseText}catch(e){o=a}var l=new Error(o);l.code=e.target.status,l.response=a,i(l)}}catch(e){i(e)}},"function"==typeof n.config&&(h=n.config(h,n,t)||h)!==p&&(o=h.abort,h.abort=function(){d=!0,o.call(this)}),null==l?h.send():"function"==typeof n.serialize?h.send(n.serialize(l)):l instanceof e.FormData?h.send(l):h.send(JSON.stringify(l))})),jsonp:s((function(t,n,r,o){var s=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+i++,a=e.document.createElement("script");e[s]=function(t){delete e[s],a.parentNode.removeChild(a),r(t)},a.onerror=function(){delete e[s],a.parentNode.removeChild(a),o(new Error("JSONP request failed"))},a.src=t+(t.indexOf("?")<0?"?":"&")+encodeURIComponent(n.callbackKey||"callback")+"="+encodeURIComponent(s),e.document.documentElement.appendChild(a)}))}}},843:(e,t,n)=>{"use strict";var r=n(9165);e.exports=n(3223)(window,r)},3873:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>g});var r=n(3379),i=n.n(r),o=n(7795),s=n.n(o),a=n(569),l=n.n(a),c=n(3565),u=n.n(c),h=n(9216),d=n.n(h),p=n(4589),f=n.n(p),_=n(1315),m={};m.styleTagTransform=f(),m.setAttributes=u(),m.insert=l().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=d(),i()(_.Z,m);const g=_.Z&&_.Z.locals?_.Z.locals:void 0},3379:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},s=[],a=0;a<e.length;a++){var l=e[a],c=r.base?l[0]+r.base:l[0],u=o[c]||0,h="".concat(c," ").concat(u);o[c]=u+1;var d=n(h),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)t[d].references++,t[d].updater(p);else{var f=i(p,r);r.byIndex=a,t.splice(a,0,{identifier:h,updater:f,references:1})}s.push(h)}return s}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var o=r(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=n(o[s]);t[a].references--}for(var l=r(e,i),c=0;c<o.length;c++){var u=n(o[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}o=l}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},9216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},8903:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(865));n(3873);var o=n(9525),s=n(9879),a=document.getElementById("app-container");if(null===a)throw new Error("The content-container was not found");i.default.route.prefix="#",(0,s.setLocalId)(),i.default.route(a,"/",{"/":o.mainPage})},8853:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.model=void 0;var i=n(6481),o=r(n(865)),s=n(4729);t.model={focused:!1,handleInit:function(){document.addEventListener("click",t.model.handleDocClick)},handleRemove:function(){document.removeEventListener("click",t.model.handleDocClick)},handleInputClick:function(){t.model.focused=!t.model.focused,o.default.redraw()},handleDocClick:function(e){var n=document.querySelector(".date-picker-container");t.model.focused&&!(null==n?void 0:n.contains(e.target))&&(t.model.focused=!1,o.default.redraw())},handleCalendarInit:function(e){var t=e.attrs.selectedDate;e.state.selectedYear=parseInt(t.slice(0,4)),e.state.selectedMonth=parseInt(t.slice(5,7))-1,e.state.tempDate=e.attrs.selectedDate,e.state.monthOptions=i.months.map((function(e,t){return{text:e,value:(0,s.convertMonthNumToString)(t)}})),e.state.yearOptions=(0,s.getYearOptions)()},handleSelectMonth:function(e,t){t.state.selectedMonth=parseInt(e)-1,o.default.redraw()},handleSelectYear:function(e,t){t.state.selectedYear=parseInt(e),o.default.redraw()},handleSelectTempDate:function(e,t){t.state.tempDate=e,o.default.redraw()},handleApply:function(e){(0,e.attrs.onInput)(e.state.tempDate),t.model.handleUnfocus()},handleGoToToday:function(e){},handleUnfocus:function(){t.model.focused=!1,o.default.redraw()}}},1998:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.datePickerCalendar=t.datePicker=void 0;var i=n(668),o=n(5883),s=r(n(865)),a=n(9929),l=n(8853),c=r(n(6104)),u=n(4729);t.datePicker={oninit:l.model.handleInit,onremove:l.model.handleRemove,view:function(e){var n=e.attrs,r=n.selectedDate,i=n.onInput,c=l.model.focused;return(0,s.default)(".date-picker-container",[(0,s.default)(".icon",s.default.trust(o.CALENDAR_ICON_SVG)),(0,s.default)("input.date-display ".concat(c?"focused":""),(0,a.extendButtonAttrs)({onclick:function(){return l.model.handleInputClick()},readonly:!0,value:r,tabindex:0})),c&&(0,s.default)(t.datePickerCalendar,{selectedDate:r,onInput:i})])}},t.datePickerCalendar={oninit:l.model.handleCalendarInit,view:function(e){e.attrs.selectedDate;var t=e.state,n=t.monthOptions,r=t.yearOptions,o=t.selectedMonth,h=t.selectedYear,d=t.tempDate;return(0,s.default)(".date-calendar-container",[(0,s.default)(".top-calendar-row",[(0,s.default)(".month-dropdown",(0,s.default)(i.dropdown,{id:(0,c.default)(),options:n,selectedValue:(0,u.convertMonthNumToString)(o),onInput:function(t){return l.model.handleSelectMonth(t,e)}})),(0,s.default)(".year-dropdown",(0,s.default)(i.dropdown,{id:(0,c.default)(),options:r,selectedValue:h.toString(),onInput:function(t){return l.model.handleSelectYear(t,e)}}))]),(0,s.default)(".middle-calendar-row",(0,u.getCalendarRows)(o,h,d,(function(t){return l.model.handleSelectTempDate(t,e)}))),(0,s.default)(".bottom-calendar-row",[(0,s.default)("button.btn-styled.small",(0,a.extendButtonAttrs)({onclick:l.model.handleUnfocus}),"Cancel"),(0,s.default)("button.btn-styled.small",(0,a.extendButtonAttrs)({onclick:function(){return l.model.handleApply(e)}}),"Apply")])])}}},3465:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.model=void 0;var i=n(3715),o=r(n(865)),s=n(9929);t.model={handleInit:function(e){e.state.open=!1,e.state.index=-1},handleRemove:function(e){},handleInputClick:function(e){e.state.open?t.model.handleBlur(e):t.model.handleFocus(e)},handleFocus:function(e){e.state.open=!0,o.default.redraw()},handleBlur:function(e){e.state.open=!1,e.state.index=-1,o.default.redraw()},handleKeyPress:function(e,n){var r=e.attrs.options,a=e.state,l=a.open,c=a.index,u=r.length;n.keyCode===i.ENTER_KEY_CODE?-1===c?t.model.handleInputClick(e):t.model.handleSelectOption(e,r[c].value):l&&(0,s.isNextPress)(n)?(n.preventDefault(),e.state.index=c<u-1?c+1:-1):l&&(0,s.isPrevPress)(n)?(n.preventDefault(),e.state.index=c>=0?c-1:u-1):9===n.keyCode&&t.model.handleBlur(e),o.default.redraw()},handleSelectOption:function(e,n){(0,e.attrs.onInput)(n),t.model.handleBlur(e)}}},668:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.dropdown=void 0;var i=n(5883),o=r(n(865)),s=n(3465);t.dropdown={oninit:s.model.handleInit,onremove:s.model.handleRemove,view:function(e){var t,n=e.attrs,r=n.options,a=n.selectedValue,l=(n.onInput,n.id),c=e.state,u=c.open,h=c.index;return(0,o.default)(".dropdown-container#".concat(l,".").concat(l),[(0,o.default)("input.select-options".concat(u?".open":""),{onclick:function(){return s.model.handleInputClick(e)},onkeydown:function(t){return s.model.handleKeyPress(e,t)},readonly:!0,value:null===(t=r.find((function(e){return e.value===a})))||void 0===t?void 0:t.text,tabindex:0,placeholder:""}),(0,o.default)(".dropdown-icon",o.default.trust(u?i.CARET_UP:i.CARET_DOWN)),u&&(0,o.default)(".dropdown-options",r.map((function(t,n){var r=t.value,i=t.text;return(0,o.default)(".dropdown-option".concat(a===r?".selected":"").concat(h===n?".focused":""),{onclick:function(){return s.model.handleSelectOption(e,r)}},i)})))])}}},6481:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DAYS_IN_A_WEEK=t.daysOfTheWeek=t.months=void 0,t.months=["January","Febuary","March","April","May","June","July","August","September","October","November","December"],t.daysOfTheWeek=["Su","M","Tu","W","Th","F","Sa"],t.DAYS_IN_A_WEEK=7},5883:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CARET_RIGHT=t.CARET_LEFT=t.CARET_DOWN=t.CARET_UP=t.CALENDAR_ICON_SVG=void 0,t.CALENDAR_ICON_SVG='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar-week" viewBox="0 0 16 16">\n<path d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-5 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"/>\n<path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>\n</svg>',t.CARET_UP='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-up-fill" viewBox="0 0 16 16">\n<path d="m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"/>\n</svg>',t.CARET_DOWN='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-down-fill" viewBox="0 0 16 16">\n<path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>\n</svg>',t.CARET_LEFT='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-left-fill" viewBox="0 0 16 16">\n<path d="m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z"/>\n</svg>',t.CARET_RIGHT='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-right-fill" viewBox="0 0 16 16">\n<path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/>\n</svg>'},3715:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TAB_KEY_CODE=t.DOWN_KEY_CODE=t.RIGHT_KEY_CODE=t.UP_KEY_CODE=t.LEFT_KEY_CODE=t.ENTER_KEY_CODE=void 0,t.ENTER_KEY_CODE=13,t.LEFT_KEY_CODE=37,t.UP_KEY_CODE=38,t.RIGHT_KEY_CODE=39,t.DOWN_KEY_CODE=40,t.TAB_KEY_CODE=9},6767:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.firebaseConfig=t.NasaApiKey=void 0,t.NasaApiKey="74QanzWhqdF1R643za8Py5tZzcmlpRbyhtCa0o6l",t.firebaseConfig={apiKey:"AIzaSyBUy3WEdpe-eSeNsiEivO2qAliAuaQDaFU",authDomain:"kerbal-view.firebaseapp.com",databaseURL:"https://kerbal-view-default-rtdb.firebaseio.com",projectId:"kerbal-view",storageBucket:"kerbal-view.appspot.com",messagingSenderId:"496669302569",appId:"1:496669302569:web:29d7e4b25bdd719cba6138"}},5256:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PIC_OF_THE_DAY_URL=void 0,t.PIC_OF_THE_DAY_URL="https://api.nasa.gov/planetary/apod?api_key="},4346:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseStoreData=void 0,t.baseStoreData={likes:0,liked:!1,loading:!1}},4531:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchPost=void 0;var s,a=n(8362),l=n(121),c=o(n(865)),u=n(5527);t.fetchPost=function(e){return r(void 0,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:s&&s(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(0,l.getPicOfTheDay)(e)];case 2:return t=r.sent(),u.store.imageData=t,(n=u.store.imageData.url)&&(s=(0,a.watchPost)(n)),u.store.fetchError=!1,[3,4];case 3:return r.sent(),u.store.fetchError=!0,[3,4];case 4:return c.default.redraw(),[2]}}))}))}},5527:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.store=void 0;var r=n(4729);t.store={postData:{likes:0,liked:!1,loading:!0},date:(0,r.getDateString)((new Date).toLocaleDateString("en-US")),fetchError:!1,imageData:{}}},9879:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalId=t.setLocalId=void 0;var i=r(n(6104));t.setLocalId=function(){(0,t.getLocalId)()||localStorage.setItem("id",(0,i.default)())},t.getLocalId=function(){return localStorage.getItem("id")}},1362:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.display=void 0;var i=n(5527),o=r(n(865)),s=n(8362),a=r(n(6104)),l=n(9929);t.display={view:function(e){var t=i.store.imageData,n=i.store.postData;if(!t)return(0,o.default)(".loading","loading");var r=n.likes,s=n.liked,u=n.loading,h=t.date,d=t.explanation,p=t.url,f=t.title,_=t.media_type,m="image"===_,g="video"===_;return(0,o.default)("card.image-display#".concat((0,a.default)()),[(0,o.default)("header.title-elements",[(0,o.default)("h2.title",f),(0,o.default)("h2.date",h)]),m&&(0,o.default)("img.pic-of-the-day",{src:p}),g&&(0,o.default)("video.pic-of-the-day",{src:p}),(0,o.default)("footer.bottom-row",[(0,o.default)("aside.like-section",[(0,o.default)("h4.like-display".concat(s?".liked":""),r),(0,o.default)("button.btn-styled",(0,l.extendButtonAttrs)({disabled:u,onclick:function(e){return c.handleLikePress(p,s)}}),s?"Unlike":"Like")]),(0,o.default)("p.description",d)])])}};var c={handleLikePress:function(e,t){t?(0,s.unlikePhoto)(e):(0,s.likePhoto)(e)}}},9691:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.model=void 0;var s=n(4531),a=n(5527),l=o(n(865)),c=n(4729);t.model={handleInit:function(e){return r(void 0,void 0,void 0,(function(){var n;return i(this,(function(r){return n=a.store.date,(0,s.fetchPost)(n),t.model.setPrevNextDay(e),[2]}))}))},handleChangeDate:function(e,n){a.store.date=e,(0,s.fetchPost)(e),t.model.setPrevNextDay(n),l.default.redraw()},setPrevNextDay:function(e){var t=a.store.date;e.state.prevDay=(0,c.getNewDay)(t,-1),e.state.nextDay=(0,c.getNewDay)(t,1)}}},9525:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.mainPage=void 0;var i=n(1998),o=n(5883),s=n(5527),a=r(n(865)),l=n(9929),c=n(1362),u=n(9691);t.mainPage={oninit:u.model.handleInit,view:function(e){var t=s.store.date,n=s.store.fetchError,r=e.state,h=r.nextDay,d=r.prevDay,p=new Date>new Date(h.replace("-","/"));return(0,a.default)("section.main-container",[(0,a.default)("section.top-row",[(0,a.default)(".logo",(0,a.default)("img",{src:"https://storage.cloud.google.com/kerbal-view.appspot.com/Voyager-logo.png"})),(0,a.default)(".date-picker-outer",(0,a.default)(i.datePicker,{selectedDate:t,onInput:function(t){return u.model.handleChangeDate(t,e)}}))]),(0,a.default)(".subtitle","Powered by Nasa's Photo of the Day API"),!n&&(0,a.default)("section.button-row",[(0,a.default)("button.arrow-button.btn-styled.secondary",(0,l.extendButtonAttrs)({onclick:function(){return u.model.handleChangeDate(d,e)}}),a.default.trust(o.CARET_LEFT)),(0,a.default)(".space"),(0,a.default)("button.arrow-button.btn-styled.secondary".concat(p?"":".disabled"),(0,l.extendButtonAttrs)({onclick:function(){return u.model.handleChangeDate(h,e)},disabled:!p}),a.default.trust(o.CARET_RIGHT))]),(0,a.default)("section.middle-row",[!n&&(0,a.default)(c.display),n&&(0,a.default)(".error-display",(0,a.default)("h3.","Could not fetch image data for the selected date."),(0,a.default)("h3.","Please select another current or past date."))])])}}},8362:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.watchPost=t.unlikePhoto=t.likePhoto=void 0;var l=n(2956),c=n(6767),u=n(5503),h=n(9879),d=n(1487),p=n(5527),f=a(n(865)),_=n(4346),m=((0,u.initializeApp)(c.firebaseConfig),(0,l.getDatabase)()),g=function(e){return i(void 0,void 0,Promise,(function(){return o(this,(function(t){return[2,(0,l.get)((0,l.ref)(m,(0,d.removeNonAlphaNumbericChars)(e))).then((function(e){var t;return(null===(t=e.val())||void 0===t?void 0:t.likeList)||[]}))]}))}))};t.likePhoto=function(e){return i(void 0,void 0,void 0,(function(){var t,n,r;return o(this,(function(i){switch(i.label){case 0:return t=(0,d.removeNonAlphaNumbericChars)(e),[4,g(t)];case 1:return n=i.sent(),r=s(s([],n||[],!0),[(0,h.getLocalId)()],!1),(0,l.set)((0,l.ref)(m,t),{url:e,likeList:r}),[2]}}))}))},t.unlikePhoto=function(e){return i(void 0,void 0,void 0,(function(){var t,n,r;return o(this,(function(i){switch(i.label){case 0:return t=(0,d.removeNonAlphaNumbericChars)(e),[4,g(t)];case 1:return n=i.sent(),r=n.filter((function(e){return e!==(0,h.getLocalId)()})),(0,l.set)((0,l.ref)(m,t),{url:e,likeList:r}),[2]}}))}))},t.watchPost=function(e){return(0,l.onValue)((0,l.ref)(m,(0,d.removeNonAlphaNumbericChars)(e)),(function(e){var t=e.val();if(!(null==t?void 0:t.likeList))return p.store.postData=r(r({},_.baseStoreData),{loading:!1}),void f.default.redraw();var n=t.likeList.length,i=t.likeList.includes((0,h.getLocalId)());p.store.postData={likes:n,liked:i,loading:!1},f.default.redraw()}))}},9929:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.isPrevPress=t.isNextPress=t.extendButtonAttrs=void 0;var i=n(3715);t.extendButtonAttrs=function(e){var t=e.onclick;return t?r(r({},e),{onkeydown:function(e){e.keyCode===i.ENTER_KEY_CODE&&t()}}):e},t.isNextPress=function(e){return e.keyCode===i.RIGHT_KEY_CODE||e.keyCode===i.DOWN_KEY_CODE},t.isPrevPress=function(e){return e.keyCode===i.UP_KEY_CODE||e.keyCode===i.LEFT_KEY_CODE}},121:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPicOfTheDay=void 0;var r=n(6767),i=n(5256);t.getPicOfTheDay=function(e){return o(i.PIC_OF_THE_DAY_URL+r.NasaApiKey+"&date="+e)};var o=function(e){return fetch(e,{method:"GET"}).then((function(e){if(e.ok)return e.json();throw new Error(e.statusText)}))}},4729:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getNewDay=t.getCalendarRows=t.getYearOptions=t.convertMonthNumToString=t.getDateString=void 0;var o=n(6481),s=i(n(865)),a=n(9929);t.getDateString=function(e){return c(e)},t.convertMonthNumToString=function(e){return(e+1).toString().padStart(2,"0")},t.getYearOptions=function(){return(e=(new Date).getFullYear(),new Array(10).fill("0").map((function(t,n){return e-n}))).map((function(e){var t=e.toString();return{value:t,text:t}}));var e},t.getCalendarRows=function(e,t,n,i){for(var c=new Date(t,e,1).getDay(),u=new Date(t,e+1,0).getDate(),h=Math.ceil((c+u)/7),d=1-c,p=[],f=1;f<=h;f++){for(var _=[],m=function(r){var o=new Date(t,e,d).getDate(),c=l(t,e,d),h=d<=0||d>u,p=c===n;_.push((0,s.default)("td",(0,s.default)("button.td-button".concat(h?".disabled":"").concat(p?".selected":""),(0,a.extendButtonAttrs)({onclick:function(){return i(c)},tabindex:h?-1:0,disabled:h}),o))),d+=1},g=1;g<=o.DAYS_IN_A_WEEK;g++)m();p.push((0,s.default)("tr.main-row",_))}return(0,s.default)("table.calendar-rows",r([(0,s.default)("tr.header-row",o.daysOfTheWeek.map((function(e){return(0,s.default)("td",(0,s.default)("label",e))})))],p,!0))};var l=function(e,n,r){return e.toString()+"-"+(0,t.convertMonthNumToString)(n)+"-"+r.toString().padStart(2,"0")},c=function(e){var t=e.split("/"),n=t[0],r=t[1],i=t[2];return"".concat(i,"-").concat(n.padStart(2,"0"),"-").concat(r.padStart(2,"0"))};t.getNewDay=function(e,n){var r=e.split("-").map((function(e){return parseInt(e)})),i=r[0],o=r[1],s=r[2],a=new Date(i,o-1,s+n).toLocaleDateString("en-US");return(0,t.getDateString)(a)}},1487:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeNonAlphaNumbericChars=void 0,t.removeNonAlphaNumbericChars=function(e){var t=new RegExp("[^a-zA-Z0-9 -]");return e.split(t).join("")}},6104:e=>{var t="undefined"!=typeof process&&process.pid?process.pid.toString(36):"";function n(){var e=Date.now(),t=n.last||e;return n.last=e>t?e:t+1}e.exports=e.exports.default=function(e,r){return(e||"")+""+t+n().toString(36)+(r||"")},e.exports.process=function(e,r){return(e||"")+t+n().toString(36)+(r||"")},e.exports.time=function(e,t){return(e||"")+n().toString(36)+(t||"")}},2238:(e,t,n)=>{"use strict";n.d(t,{ZR:()=>o.ZR,Jn:()=>C,l4:()=>u,H9:()=>f,Vr:()=>_,Af:()=>d,Z8:()=>v,lz:()=>p,qX:()=>g,Xd:()=>m,wN:()=>y,P2:()=>T,Mq:()=>x,C6:()=>E,ZF:()=>k,TP:()=>S,KN:()=>I,Ub:()=>P});var r=n(8463),i=n(3333),o=n(4444);class s{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const a="@firebase/app",l="0.7.13",c=new i.Yd("@firebase/app"),u="[DEFAULT]",h={[a]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},d=new Map,p=new Map;function f(e,t){try{e.container.addComponent(t)}catch(n){c.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function _(e,t){e.container.addOrOverwriteComponent(t)}function m(e){const t=e.name;if(p.has(t))return c.debug(`There were multiple attempts to register component ${t}.`),!1;p.set(t,e);for(const t of d.values())f(t,e);return!0}function g(e,t){return e.container.getProvider(t)}function y(e,t,n=u){g(e,t).clearInstance(n)}function v(){p.clear()}const w=new o.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class b{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.wA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw w.create("app-deleted",{appName:this._name})}}const C="9.6.3";function k(e,t={}){"object"!=typeof t&&(t={name:t});const n=Object.assign({name:u,automaticDataCollectionEnabled:!1},t),i=n.name;if("string"!=typeof i||!i)throw w.create("bad-app-name",{appName:String(i)});const s=d.get(i);if(s){if((0,o.vZ)(e,s.options)&&(0,o.vZ)(n,s.config))return s;throw w.create("duplicate-app",{appName:i})}const a=new r.H0(i);for(const e of p.values())a.addComponent(e);const l=new b(e,n,a);return d.set(i,l),l}function x(e=u){const t=d.get(e);if(!t)throw w.create("no-app",{appName:e});return t}function E(){return Array.from(d.values())}async function T(e){const t=e.name;d.has(t)&&(d.delete(t),await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function I(e,t,n){var i;let o=null!==(i=h[e])&&void 0!==i?i:e;n&&(o+=`-${n}`);const s=o.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const e=[`Unable to register library "${o}" with version "${t}":`];return s&&e.push(`library name "${o}" contains illegal characters (whitespace or "/")`),s&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void c.warn(e.join(" "))}m(new r.wA(`${o}-version`,(()=>({library:o,version:t})),"VERSION"))}function S(e,t){if(null!==e&&"function"!=typeof e)throw w.create("invalid-log-argument");(0,i.Am)(e,t)}function P(e){(0,i.Ub)(e)}m(new r.wA("platform-logger",(e=>new s(e)),"PRIVATE")),I(a,l,""),I(a,l,"esm2017"),I("fire-js","")},8463:(e,t,n)=>{"use strict";n.d(t,{wA:()=>i,H0:()=>a});var r=n(4444);class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const o="[DEFAULT]";class s{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.BH;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:o})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e="[DEFAULT]"){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e="[DEFAULT]"){return this.instances.has(e)}getOptions(e="[DEFAULT]"){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===o?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e="[DEFAULT]"){return this.component?this.component.multipleInstances?e:o:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new s(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},3333:(e,t,n)=>{"use strict";n.d(t,{in:()=>i,Yd:()=>c,Ub:()=>u,Am:()=>h});const r=[];var i;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));const o={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},s=i.INFO,a={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},l=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=a[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class c{constructor(e){this.name=e,this._logLevel=s,this._logHandler=l,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in i))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?o[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...e),this._logHandler(this,i.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...e),this._logHandler(this,i.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,i.INFO,...e),this._logHandler(this,i.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,i.WARN,...e),this._logHandler(this,i.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,i.ERROR,...e),this._logHandler(this,i.ERROR,...e)}}function u(e){r.forEach((t=>{t.setLogLevel(e)}))}function h(e,t){for(const n of r){let r=null;t&&t.level&&(r=o[t.level]),n.userLogHandler=null===e?null:(t,n,...o)=>{const s=o.map((e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((e=>e)).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:i[n].toLowerCase(),message:s,args:o,type:t.name})}}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(8903)})();